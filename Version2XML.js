function setV2(NEMSISElementNumber, v3Val, compValue) 
{
    //    console.log(NEMSISElementNumber);
    var _retv = "";
    //    console.log(codeVal);
    switch (NEMSISElementNumber) {
        case "eArrest.01":

            if (eArrest01[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest01[v3Val];
            }
            break;
        case "eArrest.02":
            if (eArrest02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest02[v3Val];
            }
            break;
        case "eArrest.03":
            if (eArrest03[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest03[v3Val];
            }
            break;

        case "eArrest.04":
            if (eArrest04[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest04[v3Val];
            }
            break;


        case "eArrest.07":
            if (eArrest11[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest11[v3Val];
            }
            break;

        case "eArrest.12":
            if (eArrest12[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest12[v3Val];
            }
            break;

        case "eArrest.13":
            if (eArrest13[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest13[v3Val];
            }
            break;



        case "eArrest.16":
            if (eArrest16[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest16[v3Val];
            }
            break;


        case "eArrest.17":
            if (eArrest17[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eArrest17[v3Val];
            }
            break;

        case "eCrew.02":
            if (eCrew02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eCrew02[v3Val];
            }
            break;
        case "eCrew.03":
            if (eCrew03[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eCrew03[v3Val];
            }
            break;

        case "eDispatch.01":
            if (eDispatch01[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch01[v3Val];
            }
            break;

        case "eDispatch.02":
            if (eDispatch02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch02[v3Val];
            }
            break;
        case "eDispatch.03":
            if (eDispatch03[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch03[v3Val];
            }
            break;
        case "eDispatch.04":
            if (eDispatch04[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch04[v3Val];
            }
            break;
        case "eDispatch.06":
            if (eDispatch06[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch06[v3Val];
            }
            break;
        case "eDispatch.07":
            if (eDispatch07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch07[v3Val];
            }
            break;
        case "eDispatch.08":
            if (eDispatch08[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDispatch08[v3Val];
            }
            break;

        case "eDisposition.12":

            if (eDisposition12[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition12[v3Val];
            }
            break;
        case "eDisposition.13":
            if (eDisposition13[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition13[v3Val];
            }

            break;
        case "eDisposition.14":

            if (eDisposition14[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition14[v3Val];
            }
            break;

        case "eDisposition.15":

            if (eDisposition15[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition15[v3Val];
            }
            break;

        case "eDisposition.17":

            if (eDisposition17[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition17[v3Val];
            }
            break;


        case "eDisposition.19":

            if (eDisposition19[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition19[v3Val];
            }
            break;

        case "eDisposition.20":

            if (eDisposition20[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition20[v3Val];
            }
            break;
        case "eDisposition.21":

            if (eDisposition21[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eDisposition21[v3Val];
            }
            break;

        case "eExam.02":
            if (eExam02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam02[v3Val];
            }
            break;

        case "eExam.04":
            if (eExam04[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam04[v3Val];
            }
            break;

        case "eExam.05":
            if (eExam05[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam05[v3Val];
            }
            break;

        case "eExam.07":
            if (eExam07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam07[v3Val];
            }
            break;

        case "eExam.08":
            if (eExam08[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam08[v3Val];
            }
            break;

        case "eExam.09":
            if (eExam09[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam09[v3Val];
            }
            break;

        case "eExam.07":
            if (compValue == "3510001")  //General
            {
                if (eExam10_General[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_General[v3Val];
                }
            };
            if (compValue == "3510003")//Left Lower Quadrant
            {
                if (eExam10_LeftLower[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_LeftLower[v3Val];
                }
            };

            if (compValue == "3510005") //Left Upper Quadrant
            {
                if (eExam10_LeftUpper[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_LeftUpper[v3Val];
                }
            };

            if (compValue == "3510007") //Periumbilical
            {
                if (eExam10_Periumbilical[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_Periumbilical[v3Val];
                }
            };
            if (compValue == "3510009") //Right Lower Quadrant
            {
                if (eExam10_RightLower[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_RightLower[v3Val];
                }
            };
            if (compValue == "3510011")//Right Upper Quadrant
            {
                if (eExam10_RightUpper[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam10_RightUpper[v3Val];
                }
            };
            break;

        case "eExam.12":
            if (eExam12[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam12[v3Val];
            }
            break;

        case "eExam.14":
            var examSet1 = ["3513001", "3513003", "3513005", "3513007"]
            if (examSet1.indexOf(compValue) > -1) {
                if (eExam13_3513001[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam13_3513001[v3Val];
                }
            };
            var examSet2 = ["3513009", "3513011", "3513013", "3513021", "3513023", "3513027"]
            if (examSet2.indexOf(compValue) > -1) {
                if (eExam13_3513009[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam13_3513009[v3Val];
                }
            };
            var examSet2 = ["3513017", "3513019", "3513025"]
            if (examSet2.indexOf(compValue) > -1) {
                if (eExam13_3513017[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam13_3513017[v3Val];
                }
            };
            break;

        case "eExam.16":

            var examSet1 = ["3515007", "3515011", "3515015", "3515019", "3515023", "3515027", "3515039", "3515043", "3515047", "3515067", "3515071", "3515095"]
            if (examSet1.indexOf(compValue) > -1)  //Extremities, right upper
            {
                if (eExam15_ExtremitiesRightUpper[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam15_ExtremitiesRightUpper[v3Val];
                }
            };
            var examSet2 = ["3515005", "3515009", "3515013", "3515017", "3515021", "3515025", "3515037", "3515041", "3515045", "3515065", "3515069", "3515093"]
            if (examSet2.indexOf(compValue) > -1)//Extremities, left upper
            {
                if (eExam15_ExtremitiesLeftUpper[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam15_ExtremitiesLeftUpper[v3Val];
                }
            };
            var examSet3 = ["3515003", "3515031", "3515035", "3515051", "3515055", "3515059", "3515063", "3515075", "3515077", "3515079", "3515083", "3515087", "3515091"]
            if (examSet3.indexOf(compValue) > -1)//Right Lower
            {
                if (eExam15_RightLower[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam15_RightLower[v3Val];
                }
            };
            break;

            var examSet4 = ["3515001", "3515029", "3515033", "3515049", "3515053", "3515057", "3515061", "3515073", "3515075", "35150777", "3515081", "3515057", "3515089"]
            if (examSet4.indexOf(compValue) > -1)//Left Lower
            {
                if (eExam15_LeftLower[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam15_LeftLower[v3Val];
                }
            };
            break;

        case "eExam.18":
            var examSet1 = ["3517001", "3517003"] //Bilateral and Left
            if (examSet1.indexOf(compValue) > -1)//Left Lower
            {
                if (eExam18_BilateralandLeft[v3Val] == 'undefined') {
                    _retv = v3Val + " 'undefined'";
                }
                else {
                    _retv = eExam18_BilateralandLeft[v3Val];
                }
            };
            var examSet1 = ["3517001", "3517005"] //Bilateral and Right
            if (examSet1.indexOf(compValue) > -1)//Left Lower
            {
                {
                    if (eExam18_BilateralandRight[v3Val] == 'undefined') {
                        _retv = v3Val + " 'undefined'";
                    }
                    else {
                        _retv = eExam18_BilateralandRight[v3Val];
                    }
                };
            }
            break;
        case "eExam.19":
            if (eExam19[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam19[v3Val];
            }
            break;

        case "eExam.20":
            if (eExam20[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eExam20[v3Val];
            }
            break;

        case "eHistory.01":
            if (eHistory01[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory01[v3Val];
            }
            break;
        case "eHistory.05":
            if (eHistory05[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory05[v3Val];
            }
            break;
        case "eHistory.09":
            if (eHistory09[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory09[v3Val];
            }
            break;
        case "eHistory.10":
            if (eHistory10[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory10[v3Val];
            }
            break;
        case "eHistory.14":
            if (eHistory14[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory14[v3Val];
            }
            break;
        case "eHistory.15":
            if (eHistory15[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory15[v3Val];
            }
            break;
        case "eHistory.16":
            if (eHistory16[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory16[v3Val];
            }
            break;
        case "eHistory.17":
            if (eHistory17[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory17[v3Val];
            }
            break;
        case "eHistory.18":
            if (eHistory18[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eHistory18[v3Val];
            }
            break;


        case "eMedications.02":

            if (eMedication02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eMedication02[v3Val];
            }
            break;
        case "eMedications.04":

            if (eMedication04[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = (eMedication04[v3Val]);
            }
            break;
        case "eMedications.06":
            if (eMedication06[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eMedication06[v3Val];
            }
            break;
        case "eMedications.07":
            if (eMedication07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eMedication07[v3Val];
            };
            break;
        case "eMedications.08":
            if (eMedication08[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eMedication08[v3Val];
            };

            break;
        case "eMedications.07":
            if (eMedication11[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eMedication11[v3Val];
            };
            break;
        case "eOther.01":
            if (eOther01[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOther01[v3Val];
            };
            break;
        case "eOther.02":
            if (eOther02[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOther02[v3Val];
            };
            break;
        case "eOther.03":
            if (eOther03[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOther03[v3Val];
            };
            break;
        case "eOther.06":
            if (eOther06[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOther06[v3Val];
            };
            break;
        case "eOther.07":
            if (eOther07[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOther07[v3Val];
            };
            break;
        case "eOutcome.01":
            if (eOutcome01[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOutcome01[v3Val];
            };
            break;
        case "eOutcome.02":
            if (eOutcome02[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOutcome02[v3Val];
            };
            break;
        case "eOutcome.03":
            if (eOutcome03[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOutcome03[v3Val];
            };
            break;
        case "eOutcome.17":
            if (eOutcome17[v3Val] == 'undefined') {
                _retv = v3Val + "'undefined'";
            }
            else {
                _retv = eOutcome17[v3Val];
            };
            break;
        case "ePatient.13":
            if (ePatient13[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePatient13[v3Val];
            }
            break;

        case "ePatient.14":
            if (ePatient14[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePatient14[v3Val];
            }
            break;
        case "ePatient.16":
            if (ePatient16[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePatient16[v3Val];
            }
            break;
        case "ePayment.01":
            if (ePayment01[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment01[v3Val];
            }
            break;

        case "ePayment.02":
            if (ePayment02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment02[v3Val];
            }
            break;
        case "ePayment.07":
            if (ePayment11[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment11[v3Val];
            }
            break;
        case "ePayment.40":
            if (ePayment40[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment40[v3Val];
            }
            break;
        case "ePayment.50":
            if (ePayment50[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment50[v3Val];
            }
            break;
        case "ePayment.52":
            if (ePayment52[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = ePayment52[v3Val];
            }
            break;
        case "eProcedures.07":
            if (eProcedures07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eProcedures07[v3Val];
            }
            break;
        case "eProcedures.08":
            if (eProcedures08[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eProcedures08[v3Val];
            }
            break;
        case "eProcedures.07":
            if (eProcedures11[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eProcedures11[v3Val];
            }
            break;
        case "eProcedures.13":
            if (eProcedures13[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eProcedures13[v3Val];
            }
            break;

        case "eScene.04":
            if (eScene04[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eScene04[v3Val];
            }
            break;
        case "eScene.06":
            if (eScene06[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eScene06[v3Val];
            }
            break;
        case "eScene.07":
            if (eScene07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eScene07[v3Val];
            }
            break;
        case "eScene.09":
            if (eScene09[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eScene09[v3Val];
            }
            break;

        case "eSituation.06":
            if (eSituation06[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eSituation06[v3Val];
            }
            break;
        case "eSituation.07":
            if (eSituation07[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eSituation07[v3Val];
            }
            break;
        case "eSituation.08":
            if (eSituation08[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eSituation08[v3Val];
            }
            break;
        case "eSituation.09":
            if (eSituation09[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eSituation09[v3Val];
            }
            break;

        case "eSituation.10":
            if (eSituation10[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eSituation10[v3Val];
            }
            break;
        case "eVitals.02":
            if (eVitals02[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals02[v3Val];
            }
            break;
        case "eVitals.03":
            if (eVitals03[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals03[v3Val];
            }
            break;
        case "eVitals.08":
            if (eVitals08[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals08[v3Val];
            }
            break;
        case "eVitals.13":
            if (eVitals13[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals13[v3Val];
            }
            break;
        case "eVitals.15":
            if (eVitals15[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals15[v3Val];
            }
            break;
        case "eVitals.19":
            if (eVitals19[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals19[v3Val];
            }
            break;
        case "eVitals.20":
            if (eVitals20[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals20[v3Val];
            }
            break;
        case "eVitals.21":
            if (eVitals21[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals21[v3Val];
            }
            break;
        case "eVitals.22":
            if (eVitals22[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals22[v3Val];
            }
            break;
        case "eVitals.25":
            if (eVitals25[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals25[v3Val];
            }
            break;
        case "eVitals.26":
            if (eVitals26[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals26[v3Val];
            }
            break;
        case "eVitals.29":
            if (eVitals29[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals29[v3Val];
            }
            break;
        case "eVitals.31":
            if (eVitals31[v3Val] == 'undefined') {
                _retv = v3Val + " 'undefined'";
            }
            else {
                _retv = eVitals31[v3Val];
            }
            break;

        default:
            _retv = NEMSISElementNumber = " version 2 not found";
    }
    return _retv;
};
var isRequiredStateElement = function (elementID) {
    return true;
};
function XMLWriter(encoding, version) {
    if (encoding)
        this.encoding = encoding;
    if (version)
        this.version = version;
};
(function () {

    XMLWriter.prototype = {
        encoding: 'ISO-8859-1',// what is the encoding
        version: '1.0', //what xml version to use
        formatting: 'indented', //how to format the output (indented/none)  ?
        indentChar: '\t', //char to use for indent
        indentation: 1, //how many indentChar to add per level
        newLine: '\n', //character to separate nodes when formatting
        //start a new document, cleanup if we are reusing
        writeStartDocument: function (standalone) {
            this.close();//cleanup
            this.stack = [];
            this.standalone = standalone;
        },
        //get back to the root
        writeEndDocument: function () {
            this.active = this.root;
            this.stack = [];
        },
        //set the text of the doctype
        writeDocType: function (dt) {
            this.doctype = dt;
        },
        //start a new node with this name, and an optional namespace
        writeStartElement: function (name, ns) {
            if (ns)//namespace
                name = ns + ':' + name;

            var node = { n: name, a: {}, c: [] };//(n)ame, (a)ttributes, (c)hildren

            if (this.active) {
                this.active.c.push(node);
                this.stack.push(this.active);
            } else
                this.root = node;
            this.active = node;
        },
        //go up one node, if we are in the root, ignore it
        writeEndElement: function () {
            this.active = this.stack.pop() || this.root;
        },
        //add an attribute to the active node
        writeAttributeString: function (name, value) {
            if (this.active)
                this.active.a[name] = value;
        },
        //add a text node to the active node
        writeString: function (text) {
            if (this.active)
                this.active.c.push(text);
        },
        //shortcut, open an element, write the text and close
        writeElementString: function (name, text, ns) {
            this.writeStartElement(name, ns);
            this.writeString(text);
            this.writeEndElement();
        },
        //add a text node wrapped with CDATA
        writeCDATA: function (text) {
            this.writeString('<![CDATA[' + text + ']]>');
        },
        //add a text node wrapped in a comment
        writeComment: function (text) {
            this.writeString('<!-- ' + text + ' -->');
        },
        //generate the xml string, you can skip closing the last nodes
        flush: function () {
            if (this.stack && this.stack[0])//ensure it's closed
                this.writeEndDocument();

            var
                chr = '', indent = '', num = this.indentation,
                formatting = this.formatting.toLowerCase() == 'indented',
                buffer = '<?xml version="' + this.version + '" encoding="' + this.encoding + '"';

            if (this.standalone !== 'undefined')
                buffer += ' standalone="' + !!this.standalone + '"';
            buffer += ' ?>';

            buffer = [buffer];

            if (this.doctype && this.root)
                buffer.push("\'");

            if (formatting) {
                while (num--)
                    chr += this.indentChar;
            }

            if (this.root)//skip if no element was added
                format(this.root, indent, chr, buffer);

            return buffer.join(formatting ? this.newLine : '');
        },
        //cleanup, don't use again without calling startDocument
        close: function () {
            if (this.root)
                clean(this.root);
            this.active = this.root = this.stack = null;
        },
        getDocument: window.ActiveXObject
            ? function () { //MSIE
                var doc = new ActiveXObject('Microsoft.XMLDOM');
                doc.async = false;
                doc.loadXML(this.flush());
                return doc;
            }
            : function () {// Mozilla, Firefox, Opera, etc.
                return (new DOMParser()).parseFromString(this.flush(), 'text/xml');
            }
    };

    //utility, you don't need it
    function clean(node) {
        var l = node.c.length;
        while (l--) {
            if (typeof node.c[l] == 'object')
                clean(node.c[l]);
        }
        node.n = node.a = node.c = null;
    };

    //utility, you don't need it
    function format(node, indent, chr, buffer) {
        var
            xml = indent + '<' + node.n,
            nc = node.c.length,
            attr, child, i = 0;

        for (attr in node.a)
            xml += ' ' + attr + '="' + node.a[attr] + '"';

        xml += nc ? '>' : ' />';

        buffer.push(xml);

        if (nc) {
            do {
                child = node.c[i++];
                if (typeof child == 'string') {
                    if (nc == 1)//single text node
                        return buffer.push(buffer.pop() + child + '</' + node.n + '>');
                    else //regular text node
                        buffer.push(indent + chr + child);
                } else if (typeof child == 'object') //element node
                    format(child, indent + chr, chr, buffer);
            } while (i < nc);
            buffer.push(indent + '</' + node.n + '>');
        }
    };

})();

var setV2XML = function (TheCall) {

    var specMap = {
        "7701001": "-5",
        "7701003": "-15",
        "7701005": "-20",
        "8801005": "-10",
        "8801013": "-10",
        "8801015": "-10",
        "8801017": "-10",
        "8801019": "-10",
        "8801021": "-10",
        "8801023": "-10"
    };
    var specVal = ["7701001", "7701003", "7701005", "8801005", "8801013", "8801015", "8801017", "8801019", "8801021", "8801023"];

    var v3NOT_RECORDED = "7701003";
    var v3NOT_APPLICABLE = "7701001";
    var v2NOT_AVAILABLE = "-5";
    var v2NOT_REPORTING = "-15";
    var v2NOT_APPLICABLE = "-25"
    var v2NOT_RECORDED = "-20";
    var v2NOT_KNOWN = "-10";
    var v2obj = new Object();
    var v2Object = new Object();
    var v2XML = new XMLWriter('UTF-8', '1.0');
    v2XML.writeStartDocument();
    v2XML.writeStartElement('EMSDataSet');
    v2XML.writeAttributeString('xmlns', "http://www.nemsis.org  xsi:schemaLocation=http://www.nemsis.org http://nemsis.org/media/XSD_v3/_nemsis_v3.3.4/3.3.4.140328/XSDs/NEMSIS_XSDs_v3.3.4.140328/EMSDataSet_v3.xsd  xmlns:xsi=http://www.w3.org/2001/XMLSchema-instance")
    v2XML.writeAttributeString('xmlns', 'http://www.nemsis.org'); 8
    v2XML.writeAttributeString('xsi:schemaLocation', '="http://www.nemsis.org http://www.nemsis.org/media/XSD/EMSDataSet.xsd');
    v2XML.writeAttributeString('xmlns:xsi', 'http://www.w3.org/2001/XMLSchema-instance');


    v2XML.writeStartElement("Header");
    /*
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_01")
    v2XML.writeElementString("D01_01", v2obj);
    v2obje = getVersion221Values(ArrayOfVersion2Objects, "D01_03")
    v2XML.writeElementString("D01_03", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_04")
    v2XML.writeElementString("D01_04", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_07")
    v2XML.writeElementString("D01_07", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_08")
    v2XML.writeElementString("D01_08", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_09")
    v2XML.writeElementString("D01_09", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D01_21")
    v2XML.writeElementString("D01_21", v2obj);
    v2obj = getVersion221Values(ArrayOfVersion2Objects, "D02_07")
    v2XML.writeElementString("D02_07", v2obj);
    v2XML.writeStartElement("Record");
    */
    //Record
    v2XML.writeStartElement("E01");
    
    //v2obj = getVersion221Values(ArrayOfVersion2Objects, "E01_01");
    if (typeof TheCall.eRecord != 'undefined') {

        if (typeof TheCall.eRecord["eRecord.01"] != 'undefined') {
            v2XML.writeElementString("E01_01", TheCall.eRecord["eRecord.01"].vSet[0])
        };

        if (typeof TheCall.eRecord["eRecord.02"] != 'undefined') {
            v2XML.writeElementString("E01_02", TheCall.eRecord["eRecord.02"].vSet[0]);
        };
        if (typeof TheCall.eRecord["eRecord.03"] != 'undefined') {
            v2XML.writeElementString("E01_03", TheCall.eRecord["eRecord.03"].vSet[0]);
        };
        if (typeof TheCall.eRecord["eRecord.04"] != 'undefined') {
            v2XML.writeElementString("E01_04", TheCall.eRecord["eRecord.04"].vSet[0]);
        };
        v2XML.writeEndElement("E01");
    }
    
    //Response
    if (typeof TheCall.eResponse != 'undefined') {
        v2XML.writeStartElement("E02");
        if (typeof TheCall.eResponse["eResponse.01"] != 'undefined') {
            v2XML.writeElementString("E02_01", TheCall.eResponse["eResponse.01"].vSet[0]);
        };

        if (typeof TheCall.eResponse["eResponse.03"] != 'undefined') {
            if (TheCall.eResponse["eResponse.03"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.03"].vSet[0]) != -1) {
                    v2XML.writeElementString("E02_02", specMap[TheCall.eResponse["eResponse.03"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E02_02", TheCall.eResponse["eResponse.03"].vSet[0]);
            }
        }

        if (typeof TheCall.eResponse["eResponse.04"] != 'undefined') {
            if (TheCall.eResponse["eResponse.04"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.04"].vSet[0]) != -1) {
                    v2XML.writeElementString("E02_03", specMap[TheCall.eResponse["eResponse.04"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E02_03", TheCall.eResponse["eResponse.04"].vSet[0]);
            }
        };

        if (typeof TheCall.eResponse["eResponse.07"] != 'undefined') {
            if (TheCall.eResponse["eResponse.07"].IsNull == false) {
                v2XML.writeElementString("E02_05", TheCall.eResponse["eResponse.07"].vSet[0]);
            }
        };

        if (typeof TheCall.eResponse["eResponse.08"] != 'undefined') {
            if (TheCall.eResponse["eResponse.08"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.08"].vSet[0]) != -1) {
                    v2XML.writeElementString("E02_06", specMap[TheCall.eResponse["eResponse.08"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eResponse["eResponse.08"].length; i++) {
                    v2XML.writeElementString("E02_06", TheCall.eResponse["eResponse.08"].vSet[i]);
                }
            }
        };
        if (typeof TheCall.eResponse["eResponse.09"] != 'undefined') {
            if (TheCall.eResponse["eResponse.09"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.09"].vSet[0]) != -1) {
                    v2XML.writeElementString("E02_07", specMap[TheCall.eResponse["eResponse.09"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eResponse["eResponse.09"].length; i++) {
                    v2XML.writeElementString("E02_07", TheCall.eResponse["eResponse.09"].vSet[i]);
                }
            }
        };

        if (typeof TheCall.eResponse["eResponse.07"] != 'undefined') {
            if (TheCall.eResponse["eResponse.07"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.07"][0]) != -1) {
                    v2XML.writeElementString("E02_09", specMap[TheCall.eResponse["eResponse.07"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eResponse["eResponse.07"].length; i++) {
                    v2XML.writeElementString("E02_09", TheCall.eResponse["eResponse.07"].vSet[io]);
                }
            }
        };

        if (typeof TheCall.eResponse["eResponse.12"] != 'undefined') {
            if (TheCall.eResponse["eResponse.12"].IsNull == true) {
                if (specVal.indexOf(TheCall.eResponse["eResponse.12"][0]) != -1) {
                    v2XML.writeElementString("E02_10", specMap[TheCall.eResponse["eResponse.12"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eResponse["eResponse.12"].length; i++) {
                    v2XML.writeElementString("E02_10", TheCall.eResponse["eResponse.12"].vSet[i]);
                }
            }
        };
        if (typeof TheCall.eResponse["eResponse.13"] != 'undefined') {
            if (TheCall.eResponse["eResponse.13"].IsNull == true) {
                v2XML.writeElementString("E02_11", "-5");
            }
            else {
                v2XML.writeElementString("E02_11", TheCall.eResponse["eResponse.13"].vSet[0]);
            }
        }
        else {
            v2XML.writeElementString("E02_11", "-10");
        };
        if (typeof TheCall.eResponse["eResponse.14"] != 'undefined') {
            if (TheCall.eResponse["eResponse.14"].IsNull == false) {
                v2XML.writeElementString("E02_12", TheCall.eResponse["eResponse.14"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.16"] != 'undefined') {
            if (TheCall.eResponse["eResponse.16"].IsNull == true) {
                v2XML.writeElementString("E02_13", "-5");
            }
            else {
                v2XML.writeElementString("E02_13", TheCall.eResponse["eResponse.16"].vSet[0]);
            }
        };
        v2XML.writeElementString("E02_14", "-5"); //Dispatch Zone
        if (typeof TheCall.eResponse["eResponse.17"] != 'undefined') {
            if (TheCall.eResponse["eResponse.17"].IsNull == false) {
                v2XML.writeElementString("E02_15", TheCall.eResponse["eResponse.17"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.19"] != 'undefined') {
            if (TheCall.eResponse["eResponse.19"].IsNull == false) {
                v2XML.writeElementString("E02_16", TheCall.eResponse["eResponse.19"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.20"] != 'undefined') {
            if (TheCall.eResponse["eResponse.20"].IsNull == false) {
                v2XML.writeElementString("E02_17", TheCall.eResponse["eResponse.20"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.21"] != 'undefined') {
            if (TheCall.eResponse["eResponse.21"].IsNull == false) {
                v2XML.writeElementString("E02_18", TheCall.eResponse["eResponse.21"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.22"] != 'undefined') {
            if (TheCall.eResponse["eResponse.22"].IsNull == false) {
                v2XML.writeElementString("E02_19", TheCall.eResponse["eResponse.22"].vSet[0]);
            }
        };
        if (typeof TheCall.eResponse["eResponse.23"] != 'undefined') {
            if (TheCall.eResponse["eResponse.23"].IsNull == false) {
                v2XML.writeElementString("E02_20", TheCall.eResponse["eResponse.23"].vSet[0]);
            }
        };

        v2XML.writeEndElement("E02");
        ////////////////////////////////////////////////////
    };  

    
    if (typeof TheCall.eDispatch != 'undefined') 
    {
        v2XML.writeStartElement("E03");
        if (typeof TheCall.eDispatch["eDispatch.01"] != 'undefined')
        {
            if (TheCall.eDispatch["eDispatch.01"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eDispatch["eDispatch.01"].vSet[0]) != -1)
                {
                    v2XML.writeElementString("E03_01", specMap[TheCall.eDispatch["eDispatch.01"].vSet[0]]);
                }
            }

            else
            {
                v2XML.writeElementString("E03_01", TheCall.eDispatch["eDispatch.01"].vSet[0]);
            }
        };

        if (typeof TheCall.eDispatch["eDispatch.02"] != 'undefined') {
            if (TheCall.eDispatch["eDispatch.02"].IsNull == true)
                if (specVal.indexOf(TheCall.eDispatch["eDispatch.02"].vSet[0]) != -1) {
                    v2XML.writeElementString("E03_02", specMap[TheCall.eDispatch["eDispatch.02"].vSet[0]]);
                }
        }
        else {
            v2XML.writeElementString("E03_02", TheCall.eDispatch["eDispatch.02"].vSet[0]);
        
        };

        if (typeof TheCall.eDispatch["eDispatch.03"] != 'undefined') {
            if (TheCall.eDispatch["eDispatch.03"].IsNull== true)
                v2XML.writeElementString("E03_03", "");
            }
            else {
                v2XML.writeElementString("E03_03", TheCall.eDispatch["eDispatch.03"].vSet[0]);
            }
        };
        v2XML.writeEndElement("E03");
   
          
    /////////////////////////////////////////////////////
    
    if (typeof TheCall.TheCrew != 'undefined') {
        for (var i = 0; i < TheCall.eCrew.CrewGroup.length; i++) 
        {
            v2XML.writeStartElement("E04");
            if (typeof TheCall.eCrew.CrewGroup[i]["eCrew.01"] != 'undefined') 
            {
                if (TheCall.eCrew.CrewGroup[i]["eCrew.01"].IsNull== true)
                {
                    if (specVal.indexOf(TheCall.eDispatch["eCrew.01"].vSet[0]) != -1) 
                    {
                        v2XML.writeElementString("E04_01", specMap[TheCall.eCrew.CrewGroup[i]["eCrew.01"].vSet[0]]);
                    }
                }
                else 
                {
                    v2XML.writeElementString("E04_01", TheCall.eCrew.CrewGroup[i]["eCrew.01"].vSet[0]);
                }
            };

            if (typeof TheCall.eCrew.CrewGroup[i]["eCrew.02"] != 'undefined') 
            {
                if (TheCall.eCrew.CrewGroup[i]["eCrew.02"].IsNull== true)
                {
                    if (specVal.indexOf(TheCall.eCrew["eCrew.02"].vSet[0]) != -1) 
                    {
                        v2XML.writeElementString("E04_03", specMap[TheCall.eCrew.CrewGroup[i]["eCrew.02"].vSet[0]]);
                    }
                }
            }
            else 
            {
                v2XML.writeElementString("E04_03", TheCall.eCrew.CrewGroup[i]["eCrew.02"].vSet[0]);
            };

            if (typeof TheCall.eCrew.CrewGroup[i]["eCrew.03"] != 'undefined') {
                if (TheCall.eCrew.CrewGroup[i]["eCrew.03"].IsNull== true){
                    if (TheCall.eCrew.CrewGroup[i]["eCrew.03"].IsNull== true)
                        if (specVal.indexOf(TheCall.eCrew.CrewGroup[i]["eCrew.03"].vSet[0]) != -1) {
                            v2XML.writeElementString("E04_02", specMap[TheCall.eCrew.CrewGroup[i]["eCrew.03"].vSet[0]]);
                        }
                }
                else {
                    v2XML.writeElementString("E04_02", TheCall.eCrew.CrewGroup[i]["eCrew.03"].vSet[0]);
                }
            };
            v2XML.writeEndElement("E04");
        }
    };
    //////////////////////////////////////////
    //times

    
    if (typeof TheCall.eTimes != 'undefined') {
        v2XML.writeStartElement("E05");

        if (typeof TheCall.eSituation != 'undefined') {
            if (typeof TheCall.eSituation["eSituation.01"] != 'undefined') {
                if (TheCall.eSituation["eSituation.01"].IsNull != true) {
                    v2XML.writeElementString("E05_01", TheCall.eSituation["eSituation.01"].vSet[0]);
                }
            }
        };


        if (typeof TheCall.eTimes["eTimes.01"] != 'undefined') {
            if(TheCall.eTimes["eTimes.01"].IsNull != true) {
                v2XML.writeElementString("E05_02", TheCall.eTimes["eTimes.01"].vSet[0]);
            }
        };

        if (typeof TheCall.eTimes["eTimes.02"] != 'undefined') {
            if(TheCall.eTimes["eTimes.02"].IsNull != true) {
                v2XML.writeElementString("E05_03", TheCall.eTimes["eTimes.02"].vSet[0]);
            }
        };

        if (typeof TheCall.eTimes["eTimes.03"] != 'undefined') {
            if(TheCall.eTimes["eTimes.02"].IsNull != true) {
                v2XML.writeElementString("E05_04", TheCall.eTimes["eTimes.03"].vSet[0]);
            }
        };

        if (typeof TheCall.eTimes["eTimes.05"] != 'undefined') {
            if (TheCall.eTimes["eTimes.05"].IsNull == true)
                v2XML.writeElementString("E05_05", "");

            else {
                v2XML.writeElementString("E05_05", TheCall.eTimes["eTimes.05"].vSet[0]);
            }
        };
    
        if (typeof TheCall.eTimes["eTimes.06"] != 'undefined') {
            if (TheCall.eTimes["eTimes.06"].IsNull == true) {
                v2XML.writeElementString("E05_06", "");
            }

            else {
                v2XML.writeElementString("E05_06", TheCall.eTimes["eTimes.06"].vSet[0]);
            }
        };

        if (typeof TheCall.eTimes["eTimes.07"] != 'undefined') {
            if (TheCall.eTimes["eTimes.07"].IsNull == true){
                {
                    v2XML.writeElementString("E05_07", "");
                }
            }
            else {
                v2XML.writeElementString("E05_07", TheCall.eTimes["eTimes.07"].vSet[0]);
            };

            if (typeof TheCall.eTimes["eTimes.08"] != 'undefined') {
                if (TheCall.eTimes["eTimes.08"].IsNull == true)
                {
                    v2XML.writeElementString("E05_08", "");
                }
                else
                {
                    v2XML.writeElementString("E05_08", TheCall.eTimes["eTimes.08"].vSet[0]);
                }
            };

            if (typeof TheCall.eTimes["eTimes.09"] != 'undefined') {
                if (TheCall.eTimes["eTimes.09"].IsNull == true)
                {
                    v2XML.writeElementString("E05_09", "");
                }
                else
                {
                    v2XML.writeElementString("E05_09", TheCall.eTimes["eTimes.09"].vSet[0]);
                }
            };

            if (typeof TheCall.eTimes["eTimes.07"] != 'undefined') {
                if (TheCall.eTimes["eTimes.07"].IsNull == true) {
                    v2XML.writeElementString("E05_10", "");
                }

                else {
                    v2XML.writeElementString("E05_10", TheCall.eTimes["eTimes.07"].vSet[0]);
                }
            };
            /////////////////////////////////
            //////////////////////////////MANDATORY
            if (typeof TheCall.eTimes["eTimes.13"] != 'undefined')
            {
                if (TheCall.eTimes["eTimes.13"].IsNull == true)
                {
                    v2XML.writeElementString("E05_11", "");
                }

                else
                {
                    v2XML.writeElementString("E05_11", TheCall.eTimes["eTimes.13"].vSet[0]);
                }
            };

            if (typeof TheCall.eTimes["eTimes.14"] != 'undefined') {
                if ((TheCall.eTimes["eTimes.14"].vSet[0] == null) && (TheCall.eTimes["eTimes.14"].vSet[0] == "")) {
                    v2XML.writeElementString("E05_12", "");
                }

                else {
                    v2XML.writeElementString("E05_12", TheCall.eTimes["eTimes.14"].vSet[0]);
                }
            };

            if (typeof TheCall.eTimes["eTimes.15"] != 'undefined') {
                if (TheCall.eTimes["eTimes.15"].IsNull == true) {
                    v2XML.writeElementString("E05_13", "");

                }
                else {
                    v2XML.writeElementString("E05_13", TheCall.eTimes["eTimes.15"].vSet[0]);
                }
            };
        
            v2XML.writeEndElement();
        };
    };
    
    ////////////////////Patient
    if (typeof TheCall.ePatient != 'undefined') {
        v2XML.writeStartElement("E06");
        //Name Group
        v2XML.writeStartElement("E06_01_0");
        if (typeof TheCall.ePatient["ePatient.02"] != 'undefined') {
            if (TheCall.ePatient["ePatient.02"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.02"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_01", specMap[TheCall.ePatient["ePatient.02"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E06_01", TheCall.ePatient["ePatient.02"].vSet[0]);
            }
        };


        if (typeof TheCall.ePatient["ePatient.03"] != 'undefined') {
            if (TheCall.ePatient["ePatient.03"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.03"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_02", specMap[TheCall.ePatient["ePatient.03"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E06_02", TheCall.ePatient["ePatient.03"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.04"] != 'undefined') {
            if (typeof TheCall.ePatient["ePatient.04"].IsNull == false) {
                v2XML.writeElementString("E06_03", TheCall.ePatient["ePatient.04"].vSet[0]);
            }
        };

        //Address Group
        v2XML.writeStartElement("E06_04_0");
        if (typeof TheCall.ePatient["ePatient.05"] != 'undefined') {
            if (TheCall.ePatient["ePatient.05"].IsNull == true) {
                v2XML.writeElementString("E06_04", "-5");
            }
            else {
                v2XML.writeElementString("E06_04", TheCall.ePatient["ePatient.05"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.06"] != 'undefined') {
            if (TheCall.ePatient["ePatient.06"].IsNull == true) {
                v2XML.writeElementString("E06_05", "-5");
            }
            else {
                v2XML.writeElementString("E06_05", TheCall.ePatient["ePatient.06"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.07"] != 'undefined') {
            if (TheCall.ePatient["ePatient.07"].IsNull == true) {
                v2XML.writeElementString("E06_06", "-5");
            }
            else {
                v2XML.writeElementString("E06_06", TheCall.ePatient["ePatient.07"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.08"] != 'undefined') {
            if (TheCall.ePatient["ePatient.08"].IsNull == true) {
                v2XML.writeElementString("E06_07", "-5");
            }
            else {
                v2XML.writeElementString("E06_07", TheCall.ePatient["ePatient.08"][0]);
            }
        };
        v2XML.writeEndElement("E06_04_0");

        if (typeof TheCall.ePatient["ePatient.09"] != 'undefined') {
            if (TheCall.ePatient["ePatient.09"].IsNull == true) {
                v2XML.writeElementString("E06_08", "-5");
            }
            else {
                v2XML.writeElementString("E06_08", TheCall.ePatient["ePatient.09"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.10"] != 'undefined') {
            if (TheCall.ePatient["ePatient.10"].IsNull == true) {
                v2XML.writeElementString("E06_10", "-5");
            }
            else {
                v2XML.writeElementString("E06_10", TheCall.ePatient["ePatient.10"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.13"] != 'undefined') 
        {
            if (TheCall.ePatient["ePatient.13"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.13"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_11", specMap[TheCall.ePatient["ePatient.13"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E06_11", TheCall.ePatient["ePatient.13"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.14"] != 'undefined') {
            if (TheCall.ePatient["ePatient.14"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.14"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_12", specMap[TheCall.ePatient["ePatient.14"].vSet[0]]);
                    v2XML.writeElementString("E06_13", specMap[TheCall.ePatient["ePatient.14"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.ePatient["ePatient.14"].length; i++) {
                    v2XML.writeElementString("E06_12", TheCall.ePatient["ePatient.14"].vSet[i]);
                };

                if (TheCall.ePatient["ePatient.14"].vSet.indexOf("2514007") != -1) {
                    v2XML.writeElementString("E06_13", "690");
                }
                else {
                    v2XML.writeElementString("E06_13", "695");
                };

            }
        };

        if (typeof TheCall.ePatient["ePatient.15"] != 'undefined') {
            if (TheCall.ePatient["ePatient.15"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.15"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_15", specMap[TheCall.ePatient["ePatient.15"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E06_15", TheCall.ePatient["ePatient.15"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.16"] != 'undefined') {
            if (TheCall.ePatient["ePatient.16"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.16"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_15", "");
                }
            }
            else {
                v2XML.writeElementString("E06_15", TheCall.ePatient["ePatient.16"].vSet[0]);
            }
        };

        v2XML.writeEndElement("E06_14_0");

        if (typeof TheCall.ePatient["ePatient.17"] != 'undefined') {
            if (TheCall.ePatient["ePatient.17"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.17"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_16", "");
                }
            }
            else {
                v2XML.writeElementString("E06_16", TheCall.ePatient["ePatient.17"].vSet[0]);
            }
        };

        if (typeof TheCall.ePatient["ePatient.18"] != 'undefined') {
            if (TheCall.ePatient["ePatient.18"].IsNull == false) {
                if (specVal.indexOf(TheCall.ePatient["ePatient.18"].vSet[0]) != -1) {
                    v2XML.writeElementString("E06_17", "");
                }
            }          
        };


        //Driver's Licence
        v2XML.writeStartElement("E06_19_0");
        if (typeof TheCall.ePatient["ePatient.20"] != 'undefined') {
            if (TheCall.ePatient["ePatient.20"].IsNull == true) {
                v2XML.writeElementString("E06_18", "-5");
            }
            else {
                v2XML.writeElementString("E06_18", TheCall.ePatient["ePatient.20"].vSet[0]);
            }
        };
        if (typeof TheCall.ePatient["ePatient.21"] != 'undefined') {
            if (TheCall.ePatient["ePatient.21"].IsNull == true) {
                v2XML.writeElementString("E06_19", "-5");
            }
            else {
                v2XML.writeElementString("E06_19", TheCall.ePatient["ePatient.21"].vSet[0]);
            }
        };

        v2XML.writeEndElement("E06_19_0");
        v2XML.writeEndElement("E06");
    };
    
    //Payments
    if (typeof TheCall.ePayment != 'undefined') {
        v2XML.writeStartElement("E07");

        if (typeof TheCall.ePayment["ePayment.01"] != 'undefined') {
            if (typeof TheCall.ePayment["ePayment.01"].IsNull == true) {
                if (specVal.indexOf(TheCall.ePayment["ePayment.01"].vSet[0]) != -1) {
                    v2XML.writeElementString("E07_01", specMap[TheCall.ePayment["ePayment.01"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E07_01", TheCall.ePayment["ePayment.01"].vSet[0]);
            }
        };

        if (typeof TheCall.ePayment["ePayment.02"] != 'undefined') {
            if (TheCall.ePayment["ePayment.02"].IsNull == false) {
                v2XML.writeElementString("E07_02", setV2(TheCall.ePayments.InsuranceGroup["ePayment.02"].vSet[0]));
            }
        };

        //Insurance Companies
        
        for (var i = 0; i < TheCall.ePatient["Insurancegroup"]; i++) {
            v2XML.writeStartElement("E07_03_0");

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.09"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.09"].IsNull == true) {
                    v2XML.writeElementString("E07_03", "-5");
                }
                else {
                    v2XML.writeElementString("E07_03", TheCall.ePayments.InsuranceGroup[i]["ePayment.09"].vSet[0]);
                }
            };


            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.07"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.07"].IsNull == true) {
                    v2XML.writeElementString("E07_04", "-5");
                }
                else {
                    v2XML.writeElementString("E07_03", TheCall.ePayments.InsuranceGroup[i]["ePayment.09"].vSet[0]);
                }
            };

            //Address

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.12"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.12"].IsNull == true) {
                    v2XML.writeElementString("E07_05", "-5");
                }
                else {
                    v2XML.writeElementString("E07_05", TheCall.ePayments.InsuranceGroup[i]["ePayment.12"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.13"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.13"].IsNull == true) {
                    v2XML.writeElementString("E07_06", "-5");
                }
                else {
                    v2XML.writeElementString("E07_06", TheCall.ePayments.InsuranceGroup[i]["ePayment.13"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.14"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.14"].IsNull == true) {
                    v2XML.writeElementString("E07_07", "-5");
                }
                else {
                    v2XML.writeElementString("E07_07", TheCall.ePayments.InsuranceGroup[i]["ePayment.14"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.15"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.15"].IsNull == true) {
                    v2XML.writeElementString("E07_08", "-5");
                }
                else {
                    v2XML.writeElementString("E07_08", TheCall.ePayments.InsuranceGroup[i]["ePayment.15"].vSet[0]);
                }
            };
            v2XML.writeEndElement("E07_05_0");

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.17"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.17"].IsNull == true) {
                    v2XML.writeElementString("E07_09", "-5");
                }
                else {
                    v2XML.writeElementString("E07_09", TheCall.ePayments.InsuranceGroup[i]["ePayment.17"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.14"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.14"].IsNull == true) {
                    v2XML.writeElementString("E07_10", "-5");
                }
                else {
                    v2XML.writeElementString("E07_10", TheCall.ePayments.InsuranceGroup[i]["ePayment.18"].vSet[0]);
                }
            };
            v2XML.writeStartElement("E07_11_0")
            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.19"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.19"].IsNull == true) {
                    v2XML.writeElementString("E07_11", "-5");
                }
                else {
                    v2XML.writeElementString("E07_11", TheCall.ePayments.InsuranceGroup[i]["ePayment.19"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.20"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.20"].IsNull == true) {
                    v2XML.writeElementString("E07_12", "-5");
                }
                else {
                    v2XML.writeElementString("E07_12", TheCall.ePayments.InsuranceGroup[i]["ePayment.20"].vSet[0]);
                }
            };

            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.21"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.21"].IsNull == true) {
                    v2XML.writeElementString("E07_13", "-5");
                }
                else {
                    v2XML.writeElementString("E07_13", TheCall.ePayments.InsuranceGroup[i]["ePayment.21"].vSet[0]);
                }
                v2XML.writeEndElement();
            };
            
            if (typeof TheCall.ePayments.InsuranceGroup[i]["ePayment.22"] != 'undefined') {
                if (TheCall.ePayments.InsuranceGroup[i]["ePayment.22"].IsNull == true) {
                    v2XML.writeElementString("E07_14", "-5");
                }
                else {
                    v2XML.writeElementString("E07_14", setV2(TheCall.ePayments.InsuranceGroup[i]["ePayment.22"].vSet[0]));
                }
            };
        };

        if (typeof TheCall.eSituation["eSituation.14"] != 'undefined') {
            if (specVal.indexOf(TheCall.eSituation["eSituation.14"][0]) != -1) {
                v2XML.writeElementString("E07_15", specMap[TheCall.eSituation["eSituation.14"].vSet[0]]);
            }
            else {
                v2XML.writeElementString("E07_15", TheCall.eSituation["eSituation.14"].vSet[0]);
            }
        };

        if (typeof TheCall.eSituation["eSituation.15"] != 'undefined') {
            if (TheCall.eSituation["eSituation.15"].IsNull == true) {
                v2XML.writeElementString("E07_16", "-5");
            }
            else {
                v2XML.writeElementString("E07_16", setV2(TheCall.eSituation["eSituation.15"].vSet[0]));
            }
        };

        if (typeof TheCall.eSituation["eSituation.16"] != 'undefined') {
            if (TheCall.eSituation["eSituation.16"].IsNull == true) {
                v2XML.writeElementString("E07_17", "-5");
            }
            else {
                v2XML.writeElementString("E07_17", setV2(TheCall.eSituation["eSituation.16"].vSet[0]));
            }
        };

        //closest relative
        //closest relative Name
        if(typeof TheCall.ePatient[""])
            v2XML.writeStartElement("E07_18_1");
        if (typeof TheCall.ePayment["ePayment.23"] != 'undefined') 
        {
            if (TheCall.ePayment["ePayment.23"].IsNull==true) {
                v2XML.writeElementString("E07_18", "-5");
            }
            else {
                v2XML.writeElementString("E07_18", TheCall.ePayment["ePayment.23"].vSet[0]);
            }
        };
        
        if (typeof TheCall.ePayment["ePayment.24"] != 'undefined') 
        {
            if (TheCall.ePayment["ePayment.24"].IsNull==true) {
                v2XML.writeElementString("E07_19", "-5");
            }
            else {
                v2XML.writeElementString("E07_19", TheCall.ePayment["ePayment.24"].vSet[0]);
            }
        };
        
        if (typeof TheCall.ePayment["ePayment.25"] != 'undefined') 
        {
            if (TheCall.ePayment["ePayment.25"].IsNull==true){
                v2XML.writeElementString("E07_20", "-5");
            }
            else {
                v2XML.writeElementString("E07_20", TheCall.ePayment["ePayment.25"].vSet[0]);
            }
        };

        v2XML.writeEndElement("E07_18_1");

        //closest relative Address
        v2XML.writeStartElement("E07_21_0");

        if (typeof TheCall.ePayment["ePayment.26"] != 'undefined') {
            if (TheCall.ePayment["ePayment.26"].IsNull==true) {
                v2XML.writeElementString("E07_21", "-5");
            }
            else {
                v2XML.writeElementString("E07_21", TheCall.ePayment["ePayment.26"].vSet[0]);
            }
        };

        if (typeof TheCall.ePayment["ePayment.27"] != 'undefined') {
            if (TheCall.ePayment["ePayment.26"].IsNull==true){
                v2XML.writeElementString("E07_22", "-5");
            }
            else {
                v2XML.writeElementString("E07_22", TheCall.ePayment["ePayment.27"].vSet[0]);
            }
        };

        if (typeof TheCall.ePayment["ePayment.28"] != 'undefined') {
            if (TheCall.ePayment["ePayment.28"].IsNull==true){
                v2XML.writeElementString("E07_23", "-5");
            }
            else {
                v2XML.writeElementString("E07_23", TheCall.ePayment["ePayment.28"].vSet[0]);
            }
        };


        if (typeof TheCall.ePayment["ePayment.29"] != 'undefined') {
            if (TheCall.ePayment["ePayment.29"].IsNull==true){
                v2XML.writeElementString("E07_24", "-5");
            }
            else {
                v2XML.writeElementString("E07_24", TheCall.ePayment["ePayment.29"].vSet[0]);
            }
        };

        v2XML.writeEndElement("E07_21_0");
        if (typeof TheCall.ePayment["ePayment.30"] != 'undefined') {
            if (TheCall.ePayment["ePayment.30"].IsNull==true){
                v2XML.writeElementString("E07_25", "-5");
            }
            else {
                v2XML.writeElementString("E07_25", TheCall.ePayment["ePayment.30"].vSet[0]);
            }
        };

        if (typeof TheCall.ePayment["ePayment.31"] != 'undefined') {
            if (TheCall.ePayment["ePayment.31"].IsNull==true){
                v2XML.writeElementString("E07_26", "-5");
            }
            else {
                v2XML.writeElementString("E07_26", setV2(TheCall.ePayment["ePayment.31"].vSet[0]));
            }
        };
        v2XML.writeEndElement("E07_18_0");

        //Employer
        v2XML.writeStartElement("E07_27_0");
        if (typeof TheCall.ePayment["ePayment.33"] != 'undefined') {
            if (TheCall.ePayment["ePayment.33"].IsNull==true) {
                v2XML.writeElementString("E07_27", "-5");
            }
            else {
                v2XML.writeElementString("E07_27", setV2(TheCall.ePayment["ePayment.33"].vSet[0]));
            }
        };

        //Employer Address
        v2XML.writeStartElement("E07_28_0");
        if (typeof TheCall.ePayment["ePayment.34"] != 'undefined') {
            if (TheCall.ePayment["ePayment.34"].IsNull==true)
            {
                v2XML.writeElementString("E07_28", "-5");
            }
            else {
                v2XML.writeElementString("E07_28", setV2(TheCall.ePayment["ePayment.34"].vSet[0]));
            }
        };

        if (typeof TheCall.ePayment["ePayment.35"] != 'undefined') {
            if (TheCall.ePayment["ePayment.35"].IsNull ==true) {
                v2XML.writeElementString("E07_29", "-5");
            }
            else {
                v2XML.writeElementString("E07_29", setV2(TheCall.ePayment["ePayment.35"].vSet[0]));
            }
        };

        if (typeof TheCall.ePayment["ePayment.36"] != 'undefined') {
            if (TheCall.ePayment["ePayment.36"].IsNull==true){
                v2XML.writeElementString("E07_30", "-5");
            }
            else {
                v2XML.writeElementString("E07_30", setV2(TheCall.ePayment["ePayment.36"].vSet[0]));
            }
        };

        if (typeof TheCall.ePayment["ePayment.37"] != 'undefined') {
            if (TheCall.ePayment["ePayment.37"].IsNull==true) {
                v2XML.writeElementString("E07_31", "-5");
            }
            else {
                v2XML.writeElementString("E07_31", setV2(TheCall.ePayment["ePayment.37"].vSet[0]));
            }
        };

        v2XML.writeEndElement("E07_28_0");
        v2XML.writeEndElement("E07_27_0");

        if (typeof TheCall.ePayment["ePayment.39"] != 'undefined') {
            if (TheCall.ePayment["ePayment.39"].IsNull == true)
                v2XML.writeElementString("E07_32", "-5");
        }
        else {
            v2XML.writeElementString("E07_32", TheCall.ePayment["ePayment.39"].vSet[0]);
        };
        
        if (typeof TheCall.ePayment["ePayment.40"] != 'undefined') {
            if (TheCall.ePayment["ePayment.40"].IsNull ==true)
            {
                v2XML.writeElementString("E07_33", "-5");
            }
            else {
                v2XML.writeElementString("E07_33", setV2(TheCall.ePayment["ePayment.40"].vSet[0]));
            }
        };

        if (typeof TheCall.ePayment["ePayment.50"] != 'undefined') {
            if (TheCall.ePayment["ePayment.50"].IsNull==true)
            {
                v2XML.writeElementString("E07_34", "-5");
            }
            else {
                v2XML.writeElementString("E07_34", setV2(TheCall.ePayment["ePayment.50"].vSet[0]));
            }
        };

        v2XML.writeStartElement("E07_35_0");
        if (typeof TheCall.ePayment["ePayment.51"] != 'undefined') {
            if (TheCall.ePayment["ePayment.51"].IsNull==true) {
                v2XML.writeElementString("E07_35", "-5");
                v2XML.writeElementString("E07_36", "-5");
                v2XML.writeElementString("E07_37", "-5");
            }
            else {
                v2XML.writeElementString("E07_35", SETv2(TheCall.ePayment["ePayment.51"][0]));
                v2XML.writeElementString("E07_36", "-5");
                v2XML.writeElementString("E07_37", "-5");
            }
        };
        v2XML.writeEndElement();
    };

    //Scene
    
    if (typeof TheCall.eScene != 'undefined') {
        v2XML.writeStartElement("E08");

        if (typeof TheCall.eScene["eScene.02"] != 'undefined') {
            if (TheCall.eSituation["eScene.02"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.02"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_01", specMap[TheCall.eScene["eScene.02"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_01", TheCall.eScene["eScene.02"].vSet[0]);
            }
        };

        
        if (typeof TheCall.eScene["eScene.04"] != 'undefined') {
            if (TheCall.eSituation["eScene.04"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.04"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_02", specMap[TheCall.eScene["eScene.04"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_02", setV2(TheCall.eScene["eScene.04"].vSet[0]));
            }
        };
        //The date/time differential between the initial responder and the EMS unit arriving on the scene, if applicable.
        v2XML.writeElementString("E08_03", "-10");

        if (typeof TheCall.eScene["eScene.05"] != 'undefined') {
            if (TheCall.eScene["eScene.05"].IsNull == true) {
                v2XML.writeElementString("E08_04", "");
            }
            else {
                v2XML.writeElementString("E08_04", setV2(TheCall.eScene["eScene.04"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.06"] != 'undefined') {
            if (TheCall.eSituation["eScene.06"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.06"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_05", specMap[TheCall.eScene["eScene.06"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_05", setV2(TheCall.eScene["eScene.06"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.07"] != 'undefined') {
            if (TheCall.eSituation["eScene.07"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.07"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_06", specMap[TheCall.eScene["eScene.07"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_06", setV2(TheCall.eScene["eScene.07"].vSet[0]));
            }
        };


        if (typeof TheCall.eScene["eScene.09"] != 'undefined') {
            if (TheCall.eSituation["eScene.09"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.09"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_07", specMap[TheCall.eScene["eScene.09"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_07", setV2(TheCall.eScene["eScene.09"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.10"] != 'undefined') {
            if (TheCall.eSituation["eScene.10"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.10"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_08", specMap[TheCall.eScene["eScene.10"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_08", setV2(TheCall.eScene["eScene.10"].vSet[0]));
            }
        };
        v2XML.writeElementString("E08_09", "-5");
        if (typeof TheCall.eScene["eScene.07"] != 'undefined') {
            if (TheCall.eSituation["eScene.07"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.07"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_10", specMap[TheCall.eScene["eScene.07"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_10", setV2(TheCall.eScene["eScene.07"].vSet[0]));
            }
        };

        v2XML.writeStartElement("E08_11_0");
        if (typeof TheCall.eScene["eScene.15"] != 'undefined') {
            if (TheCall.eSituation["eScene.15"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.15"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_11", specMap[TheCall.eScene["eScene.15"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_11", setV2(TheCall.eScene["eScene.15"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.17"] != 'undefined') {
            if (TheCall.eSituation["eScene.17"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.17"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_12", specMap[TheCall.eScene["eScene.17"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_12", setV2(TheCall.eScene["eScene.17"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.21"] != 'undefined') {
            if (TheCall.eSituation["eScene.21"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.21"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_13", specMap[TheCall.eScene["eScene.21"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_13", setV2(TheCall.eScene["eScene.21"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.18"] != 'undefined') {
            if (TheCall.eSituation["eScene.18"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.18"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_14", specMap[TheCall.eScene["eScene.18"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_14", setV2(TheCall.eScene["eScene.18"].vSet[0]));
            }
        };

        if (typeof TheCall.eScene["eScene.19"] != 'undefined') {
            if (TheCall.eSituation["eScene.19"].IsNull == true) {
                if (specVal.indexOf(TheCall.eScene["eScene.19"].vSet[0]) != -1) {
                    v2XML.writeElementString("E08_15", specMap[TheCall.eScene["eScene.19"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E08_15", setV2(TheCall.eScene["eScene.19"].vSet[0]));
            }
        };
        v2XML.writeEndElement();
        v2XML.writeEndElement();
    };
  
    v2XML.writeStartElement("E09");
    
    v2XML.writeElementString("E09_01", "-10");
    v2XML.writeElementString("E09_02", "-10");
    v2XML.writeElementString("E09_03", "-10");
    

    if (typeof TheCall.eSituation["eSituation.02"] != 'undefined') {
        if (TheCall.eSituation["eSituation.02"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.02"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_04", specMap[TheCall.eSituation["eSituation.02"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eSituation["eSituation.02"].length; i++) {
                v2XML.writeElementString("E09_04", TheCall.eSituation["eSituation.02"].vSet[i]);
            }
        }
    };

    if (typeof TheCall.eSituation["eSituation.04"] != 'undefined') {
        if (TheCall.eSituation["eSituation.04"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.04"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_05", specMap[TheCall.eSituation["eSituation.04"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_05", TheCall.eSituation["eSituation.04"].vSet[0]);
        }
    };
    if (typeof TheCall.eSituation["eSituation.05"] != 'undefined') {
        if (TheCall.eSituation["eSituation.05"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.05"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_06", specMap[TheCall.eSituation["eSituation.05"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_06", TheCall.eSituation["eSituation.05"].vSet[0]);
        }
    };
    if (typeof TheCall.eSituation["eSituation.06"] != 'undefined') {
        if (TheCall.eSituation["eSituation.06"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.06"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_07", specMap[TheCall.eSituation["eSituation.06"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_07", TheCall.eSituation["eSituation.06"].vSet[0]);
        }
    };

    if (typeof TheCall.eSituation["eSituation.07"] != 'undefined') {
        if (TheCall.eSituation["eSituation.07"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.07"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_11", specMap[TheCall.eSituation["eSituation.07"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_11", TheCall.eSituation["eSituation.07"].vSet[0]);
        }
    };


    if (typeof TheCall.eSituation["eSituation.08"] != 'undefined') {
        if (TheCall.eSituation["eSituation.08"].IsNull ==true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.08"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_12", specMap[TheCall.eSituation["eSituation.08"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_12", TheCall.eSituation["eSituation.08"].vSet[0]);
        }
    };

    if (typeof TheCall.eSituation["eSituation.07"] != 'undefined') {
        if (TheCall.eSituation["eSituation.07"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.07"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_13", specMap[TheCall.eSituation["eSituation.07"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_13", TheCall.eSituation["eSituation.07"].vSet[0]);
        }
    };

    if (typeof TheCall.eSituation["eSituation.10"] != 'undefined') {
        if (TheCall.eSituation["eSituation.10"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.10"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_14", specMap[TheCall.eSituation["eSituation.10"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eSituation["eSituation.10"].length; i++) {
                v2XML.writeElementString("E09_14", TheCall.eSituation["eSituation.14"].vSet[i]);
            }
        }
    };

    if (typeof TheCall.eSituation["eSituation.11"] != 'undefined') {
        if (TheCall.eSituation["eSituation.11"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.11"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_15", specMap[TheCall.eSituation["eSituation.11"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_15", TheCall.eSituation["eSituation.11"].vSet[0]);
        }
    };


    if (typeof TheCall.eSituation["eSituation.12"] != 'undefined') {
        if (TheCall.eSituation["eSituation.12"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.12"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_16", specMap[TheCall.eSituation["eSituation.12"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eSituation["eSituation.12"].length; i++) {
                v2XML.writeElementString("E09_16", TheCall.eSituation["eSituation.14"].vSet[i]);
            }
        }
    };

    if (typeof TheCall.eSituation["eSituation.14"] != 'undefined') {
        if (TheCall.eSituation["eSituation.14"].IsNull == true) {
            if (specVal.indexOf(TheCall.eSituation["eSituation.14"].vSet[0]) != -1) {
                v2XML.writeElementString("E09_15", specMap[TheCall.eSituation["eSituation.14"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E09_15", TheCall.eSituation["eSituation.14"].vSet[0]);
        }
    };
    v2XML.writeEndElement();
    if (typeof TheCall.eInjury != 'undefined') {
        v2XML.writeStartElement("E10")
        if (typeof TheCall.eInjury["eInjury.01"] != 'undefined') {
            if (TheCall.eInjury["eInjury.01"].IsNull == true) {
                if (specVal.indexOf(TheCall.eInjury["eInjury.01"].vSet[0]) != -1) {
                    v2XML.writeElementString("E10_01", specMap[TheCall.eInjury["eInjury.01"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eInjury["eInjury.01"].length; i++) {
                    v2XML.writeElementString("E10_01", TheCall.eInjury["eInjury.01"].vSet[i]);
                }
            }
        };

        v2XML.writeElementString("E10_02", "-10");

        if (typeof TheCall.eInjury["eInjury.02"] != 'undefined') {
            if (TheCall.eInjury["eInjury.02"].IsNull == true) {
                if (specVal.indexOf(TheCall.eInjury["eInjury.02"].vSet[0]) != -1) {
                    v2XML.writeElementString("E10_03", specMap[TheCall.eInjury["eInjury.02"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eInjury["eInjury.02"].length; i++) {
                    v2XML.writeElementString("E10_03", setV2("eInjury.02", TheCall.eInjury["eInjury.02"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eInjury["eInjury.04"] != 'undefined') {
            if (TheCall.eInjury["eInjury.04"].IsNull == true) {
                if (specVal.indexOf(TheCall.eInjury["eInjury.04"].vSet[0]) != -1) {
                    v2XML.writeElementString("E10_04", specMap[TheCall.eInjury["eInjury.04"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eInjury["eInjury.04"].length; i++) {
                    v2XML.writeElementString("E10_04", setV2("eInjury.04", TheCall.eInjury["eInjury.04"].vSet[i]));
                }
            }
        };


        if (typeof TheCall.eInjury["eInjury.05"] != 'undefined') {
            if (TheCall.eInjury["eInjury.05"].IsNull == true) {
                if (specVal.indexOf(TheCall.eInjury["eInjury.05"].vSet[0]) != -1) {
                    v2XML.writeElementString("E10_05", specMap[TheCall.eInjury["eInjury.05"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eInjury["eInjury.05"].length; i++) {
                    v2XML.writeElementString("E10_05", setV2("eInjury.05",TheCall.eInjury["eInjury.05"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eInjury["eInjury.06"] != 'undefined') {
            v2XML.writeStartElement("E10_06_0")
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906001") {
                v2XML.writeElementString("E10_06", "1");
                v2XML.writeElementString("E10_07", "2150");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906003") {
                v2XML.writeElementString("E10_06", "1");
                v2XML.writeElementString("E10_07", "2155");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906005") {
                v2XML.writeElementString("E10_06", "1");
                v2XML.writeElementString("E10_07", "2165");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906007") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };

            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906009") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };

            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906011") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906013") {
                v2XML.writeElementString("E10_06", "2");
                v2XML.writeElementString("E10_07", "2155");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906015") {
                v2XML.writeElementString("E10_06", "2");
                v2XML.writeElementString("E10_07", "2165");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906017") {
                v2XML.writeElementString("E10_06", "2");
                v2XML.writeElementString("E10_07", "2165");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906019") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };

            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906021") {
                v2XML.writeElementString("E10_06", "3");
                v2XML.writeElementString("E10_07", "2150");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906023") {
                v2XML.writeElementString("E10_06", "3");
                v2XML.writeElementString("E10_07", "2155");
            };
            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906025") {
                v2XML.writeElementString("E10_06", "3");
                v2XML.writeElementString("E10_07", "2165");
            };

            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906019") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };

            if (TheCall.eInjury["eInjury.06"].vSet[0] == "2906019") {
                v2XML.writeElementString("E10_06", "50");
                v2XML.writeElementString("E10_07", "2160");
            };

            v2XML.writeEndElement();
            
            if (typeof TheCall.eInjury["eInjury.07"] != 'undefined')
            {
                if (TheCall.eInjury["eInjury.07"].IsNull != true)
                {
                    for (var i = 0; i < TheCall.eInjury["eInjury.07"].length; i++)
                    {
                        v2XML.writeElementString("E10_08", setV2("eInjury.07",TheCall.eInjury["eInjury.07"].vSet[i]));
                    }
                }
            };
            if (typeof TheCall.eInjury["eInjury.08"] != 'undefined') {
                if (TheCall.eInjury["eInjury.08"].IsNull == false) {
                    if (specVal.indexOf(TheCall.eInjury["eInjury.08"].vSet[0]) != -1) {
                        v2XML.writeElementString("E10_09", specMap[TheCall.eInjury["eInjury.08"].vSet[0]]);
                    }
                }
                else {
                    for (var i = 0; i < TheCall.eInjury["eInjury.08"].length; i++) {
                        v2XML.writeElementString("E10_09", setV2("eInjury.08",TheCall.eInjury["eInjury.08"].vSet[i]));
                    }
                }
            };

            if (typeof TheCall.eInjury["eInjury.09"] != 'undefined') {
                if (TheCall.eInjury["eInjury.09"].IsNull == false) {
                    v2XML.writeElementString("E10_10", TheCall.eInjury["eInjury.09"].vSet[0]);
                }
            };


            v2XML.writeElementString("E10_09", TheCall.eInjury["eInjury.10"].vSet[i]);
            

        };
    };
    v2XML.writeEndElement();
    v2XML.writeStartElement("E11");
    if (typeof TheCall.eArrest["eArrest.01"] != 'undefined') 
    {
        if (TheCall.eArrest["eArrest.01"].IsNull == true)
        {
            if (specVal.indexOf(TheCall.eArrest["eArrest.01"].vSet[0]) != -1)
            {
                v2XML.writeElementString("E11_01", specMap[TheCall.eArrest["eArrest.01"].vSet[0]]);
            }
        }
        else 
        {            
            v2XML.writeElementString("E11_01", setV2("eArrest.01", TheCall.eArrest["eArrest.01"].vSet[0]));
        }
    };

    if (typeof TheCall.eArrest["eArrest.02"] != 'undefined') 
    {
        if (TheCall.eArrest["eArrest.02"].IsNull == true)
        {
            if (specVal.indexOf(TheCall.eArrest["eArrest.02"].vSet[0]) != -1)
            {
                v2XML.writeElementString("E11_02", specMap[TheCall.eArrest["eArrest.02"].vSet[0]]);
            }
        }
        else 
        {            
            v2XML.writeElementString("E11_02", setV2("eArrest.02", TheCall.eArrest["eArrest.02"].vSet[0]));
        }
    };

    if (typeof TheCall.eArrest["eArrest.03"] != 'undefined')
    {
        if (TheCall.eArrest["eArrest.03"].IsNull == true)
        {
            if (specVal.indexOf(TheCall.eArrest["eArrest.03"].vSet[0]) != -1)
            {
                v2XML.writeElementString("E11_03", specMap[TheCall.eArrest["eArrest.03"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.03"].length; i++) {
                v2XML.writeElementString("E11_03", setV2("eArrest.03", TheCall.eArrest["eArrest.03"].vSet[i]));
            }
        }
    };

    if (typeof TheCall.eArrest["eArrest.04"] != 'undefined') {
        if (TheCall.eArrest["eArrest.04"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.04"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_04", specMap[TheCall.eArrest["eArrest.04"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.04"].length; i++) {
                v2XML.writeElementString("E11_04", setV2("eArrest.04", TheCall.eArrest["eArrest.04"].vSet[i]));
            }
        }
    };

    if (typeof TheCall.eArrest["eArrest.11"] != 'undefined') {
        if (TheCall.eArrest["eArrest.11"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.11"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_05", specMap[TheCall.eArrest["eArrest.11"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E11_05", setV2("eArrest.11", TheCall.eArrest["eArrest.11"].vSet[0]));
        }
    };

    if (typeof TheCall.eArrest["eArrest.12"] != 'undefined') {
        if (TheCall.eArrest["eArrest.12"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.12"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_06", specMap[TheCall.eArrest["eArrest.12"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.12"].length; i++) {
                v2XML.writeElementString("E11_06", setV2("eArrest.12",TheCall.eArrest["eArrest.12"].vSet[i]));
            }
        }
    };

    if (typeof TheCall.eArrest["eArrest.13"] != 'undefined') 
    {
        if (TheCall.eArrest["eArrest.13"].IsNull != true) 
        {
            v2XML.writeElementString("E11_07", setV2("eArrest.13",TheCall.eArrest["eArrest.13"].vSet[0]));
        }
    };

    if (typeof TheCall.eArrest["eArrest.14"] != 'undefined') 
    {
        if (TheCall.eArrest["eArrest.14"].IsNull == true) 
        {
            v2XML.writeElementString("E11_08", specMap[TheCall.eArrest["eArrest.14"].vSet[0]]);
        }        
        else 
        {
            v2XML.writeElementString("E11_08", TheCall.eArrest["eArrest.14"].vSet[0]);
        }
    };

    if (typeof TheCall.eArrest["eArrest.15"] != 'undefined') {
        if (TheCall.eArrest["eArrest.15"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.15"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_09", specMap[TheCall.eArrest["eArrest.15"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.15"].length; i++) {
                v2XML.writeElementString("E11_09", setV2("eArrest.15",TheCall.eArrest["eArrest.15"].vSet[i]));
            }
        }
    };

    if (typeof TheCall.eArrest["eArrest.16"] != 'undefined') {
        if (TheCall.eArrest["eArrest.16"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.16"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_10", specMap[TheCall.eArrest["eArrest.16"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.16"].length; i++) {
                v2XML.writeElementString("E11_10", setV2("eArrest.16",TheCall.eArrest["eArrest.16"].vSet[i]));
            }
        }
    };

        
    if (typeof TheCall.eArrest["eArrest.17"] != 'undefined') {
        if (TheCall.eArrest["eArrest.17"].IsNull == true) {
            if (specVal.indexOf(TheCall.eArrest["eArrest.17"].vSet[0]) != -1) {
                v2XML.writeElementString("E11_11", specMap[TheCall.eArrest["eArrest.17"].vSet[0]]);
            }
        }
        else {
            for (var i = 0; i < TheCall.eArrest["eArrest.17"].length; i++) {
                v2XML.writeElementString("E11_11", setV2("eArrest.17", TheCall.eArrest["eArrest.17"].vSet[i]));
            }
        }
    };

    v2XML.writeEndElement();
    
   
    ////////////////////eHistory
    
    v2XML.writeStartElement("E12");
    if (typeof TheCall.eHistory != 'undefined') {
        if (typeof TheCall.eHistory["eHistory.01"] != 'undefined') {
            if (TheCall.eHistory["eHistory.01"].IsNull == true) {
                if (typeof TheCall.eHistory["eHistory.01"].NV != 'undefined') {
                    v2XML.writeElementString("E12_01", specMap[TheCall.eHistory["eHistory.01"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E12_01", setV2(TheCall.eHistory["eHistory.01"].vSet[0]));
            }
        };

        v2XML.writeElementString("E12_02", "-10");
        v2XML.writeElementString("E12_03", "-10");

        if (typeof TheCall.eHistory["PractitionerGroup"] != 'undefined') {
            if (TheCall.eHistory["PractitionerGroup"] != -1) {
                v2XML.writeStartElement("E12_04_0");


                if (typeof TheCall.eHistory["eHistory.03"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.03"].IsNull == true) {
                        if (typeof TheCall.eHistory["eHistory.03"].NV != 'undefined') {
                            {
                                v2XML.writeElementString("E12_04", specMap[TheCall.eHistory["eHistory.03"].vSet[0]]);
                            }
                        }
                    }
                    else {
                        v2XML.writeElementString("E12_04", setV2(TheCall.eHistory["eHistory.03"].vSet[0]));
                    }
                };

                if (typeof TheCall.eHistory["eHistory.04"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.03"].IsNull == false) {
                        v2XML.writeElementString("E12_05", TheCall.eHistory["eHistory.04"].vSet[0]);
                    }
                };

                v2XML.writeEndElement();
            }
        };


        if (typeof TheCall.eHistory["eHistory.05"] != 'undefined') {
            if (TheCall.eHistory["eHistory.05"].IsNull == true) {
                if (typeof TheCall.eHistory["eHistory.05"].NV != 'undefined') {
                    v2XML.writeElementString("E12_07", specMap[TheCall.eHistory["eHistory.05"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eHistory["eHistory.05"].vSet.length; i++) {
                    v2XML.writeElementString("E12_07", setV2(TheCall.eHistory["eHistory.05"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eHistory["eHistory.06"] != 'undefined') {
            if (TheCall.eHistory["eHistory.06"].IsNull == true) {
                if (typeof TheCall.eHistory["eHistory.06"].NV != 'undefined') {
                    v2XML.writeElementString("E12_08", specMap[TheCall.eHistory["eHistory.06"].vSet[0]]);
                }
                else if (typeof TheCall.eHistory["eHistory.06"].PN != 'undefined') {
                    v2XML.writeElementString("E12_08", specMap[TheCall.eHistory["eHistory.06"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eHistory["eHistory.06"].vSet.length; i++) {
                    v2XML.writeElementString("E12_08", setV2(TheCall.eHistory["eHistory.06"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eHistory["eHistory.07"] != 'undefined') {
            if (TheCall.eHistory["eHistory.07"].IsNull == true) {
                if (specVal.indexOf(TheCall.eHistory["eHistory.07"].vSet[0]) != -1) {
                    v2XML.writeElementString("E12_09", specMap[TheCall.eHistory["eHistory.07"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eHistory["eHistory.07"].vSet.length; i++) {
                    v2XML.writeElementString("E12_09", setV2(TheCall.eHistory["eHistory.07"].vSet[i]));
                }
            }
        };


        if (typeof TheCall.eHistory["eHistory.08"] != 'undefined') {
            if (TheCall.eHistory["eHistory.08"].IsNull == true) {
                if (specVal.indexOf(TheCall.eHistory["eHistory.08"].vSet[0]) != -1) {
                    v2XML.writeElementString("E12_10", specMap[TheCall.eHistory["eHistory.08"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eHistory["eHistory.08"].vSet.length; i++) {
                    v2XML.writeElementString("E12_10", setV2(TheCall.eHistory["eHistory.08"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eHistory["eHistory.09"] != 'undefined') {
            if (TheCall.eHistory["eHistory.09"].IsNull == true) {
                if (specVal.indexOf(TheCall.eHistory["eHistory.09"].vSet[0]) != -1) {
                    v2XML.writeElementString("E12_11", specMap[TheCall.eHistory["eHistory.09"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eHistory["eHistory.09"].vSet.length; i++) {
                    v2XML.writeElementString("E12_11", setV2(TheCall.eHistory["eHistory.09"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eHistory["ImmunizationsGroup"] != 'undefined') {
            if (TheCall.eHistory["ImmunizationsGroup"] != -1) {
                v2XML.writeStartElement("E12_12_0");

                if (typeof TheCall.eHistory["eHistory.10"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.12"].IsNull == true)
                        if (specVal.indexOf(TheCall.eHistory["eHistory.10"].vSet[0]) != -1) {
                            v2XML.writeElementString("E12_12", specMap[TheCall.eHistory["eHistory.10"].vSet[0]]);
                        }
                        else {
                            v2XML.writeElementString("E12_12", setV2(TheCall.eHistory["eHistory.10"].vSet[i]));
                        }
                };

                if (typeof TheCall.eHistory["eHistory.11"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.11"].IsNull == true) {
                        v2XML.writeElementString("E12_13", setV2(TheCall.eHistory["eHistory.11"].vSet[0]));
                    }
                };
                v2XML.writeEndElement();
            }
        };
        if (typeof TheCall.eHistory["CurrentMedsGroup"] != 'undefined') {
            if (eHistory["CurrentMedsGroup"] != -1) {
                v2XML.writeStartElement("E12_14_0");

                if (typeof TheCall.eHistory["eHistory.12"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.12"].IsNull == true) {
                        if (specVal.indexOf(TheCall.eHistory["eHistory.12"].vSet[0]) != -1) {
                            v2XML.writeElementString("E12_14", specMap[TheCall.eHistory["eHistory.12"].vSet[0]]);
                        }
                    }
                    else {
                        v2XML.writeElementString("E12_14", setV2(TheCall.eHistory["eHistory.12"].vSet[i]));
                    }
                };

                v2XML.writeStartElement("E12_15_0");
                if (typeof TheCall.eHistory["eHistory.13"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.13"].IsNull == false) {
                        v2XML.writeElementString("E12_15", TheCall.eHistory["eHistory.13"].vSet[0]);
                    }
                };

                if (typeof TheCall.eHistory["eHistory.14"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.14"].IsNull == false) {
                        v2XML.writeElementString("E12_16", setV2(TheCall.eHistory["eHistory.13"].vSet[0]));
                    }
                };

                v2XML.writeEndElement();
                if (typeof TheCall.eHistory["eHistory.15"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.15"].IsNull == true) {
                        if (specVal.indexOf(TheCall.eHistory["eHistory.15"].vSet[0]) != -1) {
                            v2XML.writeElementString("E12_17", specMap[TheCall.eHistory["eHistory.15"].vSet[0]]);
                        }
                    }
                    else {
                        v2XML.writeElementString("E12_17", setV2(TheCall.eHistory["eHistory.15"].vSet[i]));
                    }
                };


                if (typeof TheCall.eHistory["eHistory.16"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.16"].IsNull == false) {
                        v2XML.writeElementString("E12_18", setV2(TheCall.eHistory["eHistory.16"].vSet[0]));
                    }
                };


                if (typeof TheCall.eHistory["eHistory.17"] != 'undefined') {
                    if (TheCall.eHistory["eHistory.17"].IsNull == true) {
                        if (specVal.indexOf(TheCall.eHistory["eHistory.17"].vSet[0]) != -1) {
                            v2XML.writeElementString("E12_19", specMap[TheCall.eHistory["eHistory.17"].vSet[0]]);
                        }
                    }
                    else {
                        for (var i = 0; i < TheCall.eHistory["eHistory.17"].vSet.length; i++) {
                            v2XML.writeElementString("E12_19", setV2(TheCall.eHistory["eHistory.17"].vSet[i]));
                        }
                    }
                }
            }
        };

        if (typeof TheCall.eHistory["eHistory.18"] != 'undefined') {
            if (TheCall.eHistory["eHistory.18"].IsNull == true) {
                if (specVal.indexOf(TheCall.eHistory["eHistory.18"].vSet[0]) != -1) {
                    v2XML.writeElementString("E12_20", specMap[TheCall.eHistory["eHistory.18"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E12_20", setV2(TheCall.eHistory["eHistory.18"].vSet[i]));
            }
        };

        v2XML.writeEndElement();
    };
    
    if (typeof TheCall.eVitals!= 'undefined')
    {
    
        for (var xx = 0; xx < TheCall.eVitals.VitalGroup.length; xx++) {
            v2XML.writeStartElement("E14")

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.01"] != 'undefined') 
            {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.01"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.01"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_01", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.01"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_01", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.01"].vSet[i]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.02"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.02"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.02"].vSet[0]) != -1) {
                    
                        v2XML.writeElementString("E14_02", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.02"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_02", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.02"].vSet[0]));
                }
            };
            
            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.03"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.03"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.03"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_03", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.03"].vSet[0]]);
                    }
                }
                else {
                    for (var i = 0; i < TheCall.eVitals.VitalGroup[xx]["eVitals.03"].vSet.length; i++) {
                        v2XML.writeElementString("E14_03", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.03"].vSet[i]));
                    }
                }
            };

            v2XML.writeStartElement("E14_04_0")
            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.06"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.06"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.06"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_04", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.06"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_04", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.06"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.07"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.07"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.07"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_05", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.07"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_05", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.07"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.08"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.08"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.08"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_06", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.08"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_06", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.08"].vSet[0]));
                }
            };

            v2XML.writeEndElement();

                      
            if (typeof TheCall.eVitals.VitalGroup["eVitals.10"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.10"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.10"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_08", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.10"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_08", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.10"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.12"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.12"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.12"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_09", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.12"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_09", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.12"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.13"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.13"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.13"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_10", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.13"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_10", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.13"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.14"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.14"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.14"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_11", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.14"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_11", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.14"].vSet[i]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.15"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.15"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.15"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_12", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.15"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_12", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.15"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.16"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.16"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.16"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_13", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.16"][0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_13", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.16"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.18"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.18"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.18"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_14", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.18"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_14", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.18"].vSet[0]));
                }
            };
            v2XML.writeStartElement("E14_15_0");

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.19"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.19"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.19"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_15", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.19"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_15", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.19"].vSet[0]));
                }
            };



            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.20"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.20"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.20"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_16", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.20"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_16", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.20"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.21"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.21"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.21"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_17", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.21"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_17", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.21"].vSet[0]));
                }
            };



            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.22"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.22"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.22"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_18", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.22"].vSet[0]]);
                    }
                }
                else {
                    for (var i = 0; i < TheCall.eVitals.VitalGroup[xx]["eVitals.22"].vSet.length; i++) {

                        v2XML.writeElementString("E14_18", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.22"].vSet[i]));
                    }
                }
            };

            v2XML.writeEndElement();
            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.23"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.23"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.23"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_19", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.23"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_19", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.23"].vSet[0]));
                }
            };

            v2XML.writeStartElement("E14_20_0");
            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.24"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.24"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.24"].vSet[0]) != -1) {
                        v2XML.writeElementString("E14_20", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.24"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_20", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.24"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.25"] != 'undefined') 
            {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.25"].IsNull != true) 
                { 
                    v2XML.writeElementString("E14_21", TheCall.eVitals.VitalGroup[xx]["eVitals.25"].vSet[0]);
                }
            };
            v2XML.writeEndElement();

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.26"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.26"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.26"].vSet[0]) != -1) {
                    
                        v2XML.writeElementString("E14_22", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.26"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_22", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.26"].vSet[0]));
                }
            };
            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.27"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.27"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.27"].vSet[0]) != -1) {
                    
                        v2XML.writeElementString("E14_23", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.27"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_23", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.27"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.29"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.29"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.29"].vSet[0]) != -1) {
                    
                        v2XML.writeElementString("E14_24", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.29"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_24", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.29"].vSet[0]));
                }
            };


            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.31"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.31"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eVitals.VitalGroup[xx]["eVitals.31"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E14_25", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.31"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E14_25", setV2(TheCall.eVitals.VitalGroup[xx]["eVitals.31"].vSet[0]));
                }
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.32"] != 'undefined') 
            {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.32"].IsNull != true) 
                {
                    v2XML.writeElementString("E14_26", TheCall.eVitals.VitalGroup[xx]["eVitals.32"].vSet[0]);
                }                
            };

            if (typeof TheCall.eVitals.VitalGroup[xx]["eVitals.33"] != 'undefined') {
                if (TheCall.eVitals.VitalGroup[xx]["eVitals.33"].IsNull == true) {
                    v2XML.writeElementString("E14_27", specMap[TheCall.eVitals.VitalGroup[xx]["eVitals.33"].vSet[0]]);
                }
            };
        }
    };//for

    v2XML.writeEndElement();
    
    
    
    v2XML.writeStartElement("E16");
    if (typeof TheCall.eExam["eExam.01"] != 'undefined') 
    {
        if (TheCall.eExam["eExam.01"].IsNull == true) {
            if (specVal.indexOf(TheCall.eExam["eExam.01"].vSet[0]) != -1) {
                v2XML.writeElementString("E16_01", specMap[TheCall.eExam["eExam.01"].vSet[0]]);
            }
        }
    }
    else 
    {
        v2XML.writeElementString("E16_01", TheCall.eExam["eExam.01"].vSet[0]);                        
    };

    if (typeof TheCall.eExam["eExam.02"] != 'undefined') 
    {
        if(TheCall.eExam["eExam.02"].IsNull==true)
        {
            if (specVal.indexOf(TheCall.eExam["eExam.02"].vSet[0]) != -1) {
                v2XML.writeElementString("E16_02", specMap[TheCall.eExam["eExam.02"].vSet[0]]);
            }
        }
        else 
        {          
            v2XML.writeElementString("E16_02", setV2(TheCall.eExam["eExam.02"].vSet[0]));
        }  
    };

    for (var i = 0; i < TheCall.eExam.AssessmentGroup.length; i++) {
        v2XML.writeStartElement("E16_00_0");
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.03"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.03"].vSet[0].IsNull != true) {
                v2XML.writeElementString("E16_03", TheCall.eExam.AssessmentGroup[xx]["eExam.03"].vSet[0]);
            }
        };

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.04"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.04"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.04"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_04", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.04"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.04"].vSet.length; i++) {
                    v2XML.writeElementString("E16_04", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.04"].vSet[i]));
                }
            }
        };
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.05"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.05"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.05"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_05", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.05"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.05"].vSet.length; i++) {
                    v2XML.writeElementString("E16_05", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.05"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.07"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_06", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet.length; i++) {
                    v2XML.writeElementString("E16_06", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.08"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.08"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.08"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_07", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.08"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.08"].vSet.length; i++) {
                    v2XML.writeElementString("E16_07", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.08"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.09"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.09"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.09"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_08", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.09"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.09"].vSet.length; i++) {
                    v2XML.writeElementString("E16_08", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.09"].vSet[i]));
                }
            }
        };

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.07"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_09", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet.length; i++) {
                    v2XML.writeElementString("E16_09", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.07"].vSet[i]));
                }
            }
        };

        alert("ABDOMEN LOWER LEFT")
        alert("ABDOMEN UPPER RIGHT")
        alert("ABDOMEN LOWER RIGHT")
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.12"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.12"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.12"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_13", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.12"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.12"].vSet.length; i++) {
                    v2XML.writeElementString("E16_13", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.12"].vSet[i]));
                }
            }
        };
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.14"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.14"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.14"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_14", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.14"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.14"].vSet.length; i++) {
                    v2XML.writeElementString("E16_14", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.14"].vSet[i]));
                }
            }
        };

        alert("BACK THORATIC")
        alert("BACK LUMBAR")
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.16"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.16"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.16"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_17", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.16"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.16"].vSet.length; i++) {
                    v2XML.writeElementString("E16_17", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.16"].vSet[i]));
                }
            }
        };

        alert("EXTREMITIES RIGHT LOWER")
        alert("EXTREMITIES LEFT UPPER")
        alert("EXTREMITIES LEFT LOWER")

        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.18"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.18"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.18"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_21", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.18"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.18"].vSet.length; i++) {
                    v2XML.writeElementString("E16_21", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.21"].vSet[i]));
                }
            }
        }



        alert("EYES LEFT")
        alert("EYES RIGHT")
        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.19"] != 'undefined') {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.19"].vSet[0].IsNull != true) {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.19"].vSet[0]) != -1) {
                    v2XML.writeElementString("E16_23", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.19"].vSet[0]]);
                }
            }
            else {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.19"].vSet.length; i++) {
                    v2XML.writeElementString("E16_23", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.19"].vSet[i]));
                }
            }
        };


        if (typeof TheCall.eExam.AssessmentGroup[xx]["eExam.20"] != 'undefined') 
        {
            if (TheCall.eExam.AssessmentGroup[xx]["eExam.20"].vSet[0].IsNull != true) 
            {
                if (specVal.indexOf(TheCall.eExam.AssessmentGroup[xx]["eExam.20"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E16_24", specMap[TheCall.eExam.AssessmentGroup[xx]["eExam.20"].vSet[0]]);
                }
            }
            else 
            {
                for (var i = 0; i < TheCall.eExam.AssessmentGroup[xx]["eExam.20"].vSet.length; i++) 
                {
                    v2XML.writeElementString("E16_24", setV2(TheCall.eExam.AssessmentGroup[xx]["eExam.20"].vSet[i]));
                }
            }
        };
        v2XML.writeEndElement();
    };
    v2XML.writeEndElement();
    
    if (typeof TheCall.eProtocols != 'undefined') {
        for (var xx = 0; xx < TheCall.eProtocols.ProtocolGroup.length; xx++) {
            v2XML.writeStartElement("E17")
            if (typeof TheCall.eProtocols.ProtocolGroup[xx]["eProtocols.01"] != 'undefined') {
                if (TheCall.eProtocols.ProtocolGroup[xx]["eProtocols.01"].IsNull != true) {
                    if (specVal.indexOf(TheCall.eProtocols.ProtocolGroup[xx]["eProtocols.01"].vSet[0]) != -1) {
                        v2XML.writeElementString("E17_01", specMap[TheCall.eProtocols.ProtocolGroup[xx]["eProtocols.01"].vSet[0]]);
                    }
                    else {
                        v2XML.writeElementString("E17_01", setV2(TheCall.eProtocols.ProtocolGroup[xx]["eProtocols.01"].vSet[0]));
                    }
                }
            };
            v2XML.writeEndElement();
        }
    };

    if (typeof TheCall.eMedications != 'undefined')
        {}
    v2XML.writeStartElement("E18")
    for (var xx = 0; xx < TheCall.eMedications.MedicationGroup.length; xx++) {
        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.01"] != 'undefined') 
        {            
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.01"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.01"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_01", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.01"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_01", TheCall.eMedications.MedicationGroup[xx]["eMedications.01"].vSet[0]);
            }  
        };
        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.02"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.02"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.02"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_02", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.02"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_02", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.02"].vSet[0]));
            }  
        };
        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.03"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.03"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.03"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_03", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.03"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_03", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.03"].vSet[0]));
            }  
        };

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.04"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.04"].IsNull == true) 
            {
                v2XML.writeElementString("E18_04", "-10");
            }
            else 
            {          
                v2XML.writeElementString("E18_04", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.04"].vSet[0]));
            }  
        };

        v2XML.writeStartElement("E18_05_0")
        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.05"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.05"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.05"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_05", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.05"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_05", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.05"].vSet[0]));
            }  
        };

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.06"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.06"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.06"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_06", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.06"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_06", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.06"].vSet[0]));
            }  
        };

        
        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.07"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_07", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_07", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].vSet[0]));
            }  
        };
        v2XML.writeEndElement();

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.08"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.08"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.08"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_08", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.08"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_08", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.08"].vSet[0]));
            }  
        };

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.09"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.09"].IsNull == true) 
            {
                if (specVal.indexOf(TheCall.eMedications.MedicationGroup[xx]["eMedications.09"].vSet[0]) != -1) 
                {
                    v2XML.writeElementString("E18_09", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.09"].vSet[0]]);
                }
            }
            else 
            {          
                v2XML.writeElementString("E18_09", setV2(TheCall.eMedications.MedicationGroup[xx]["eMedications.09"].vSet[0]));
            }  
        };

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.07"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].IsNull == true) 
            {
                v2XML.writeElementString("E18_10", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.07"].vSet[0]]);
            }         
        };

        if (typeof TheCall.eMedications.MedicationGroup[xx]["eMedications.12"] != 'undefined') 
        {
            if (TheCall.eMedications.MedicationGroup[xx]["eMedications.12"].IsNull == true) 
            {
                v2XML.writeElementString("E18_11", specMap[TheCall.eMedications.MedicationGroup[xx]["eMedications.12"].vSet[0]]);
            }         
        }
        v2XML.writeEndElement();
    };
        
    
    if (typeof TheCall.eProcedures != 'undefined') {
        v2XML.writeStartElement("E19")
        for (var xx = 0; xx < TheCall.eProcedures.ProcedureGroup.length; xx++) {

            v2XML.writeStartElement("E19_01_0")

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.01"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.01"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.01"].vSet[0]) != -1) {
                        v2XML.writeElementString("E19_01", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.01"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_01", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.01"].vSet[0]));
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.02"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.02"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.02"].vSet[0]) != -1) {
                        v2XML.writeElementString("E19_02", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.02"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_02", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.02"].vSet[0]));
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.03"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.03"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.03"].vSet[0]) != -1) {
                        v2XML.writeElementString("E19_03", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.03"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_03", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.03"].vSet[0]));
                }
            };


            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.04"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.04"].IsNull == true) {
                    v2XML.writeElementString("E19_04", "-5");
                }
                else {
                    v2XML.writeElementString("E19_04", TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.04"].vSet[0]);
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.05"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.05"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.05"][0]) != -1) {
                        v2XML.writeElementString("E19_05", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.05"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_05", TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.05"].vSet[0]);
                }
            };


            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.06"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.06"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.06"][0]) != -1) {
                        v2XML.writeElementString("E19_06", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.06"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_06", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.06"].vSet[0]));
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"][0]) != -1) {
                        v2XML.writeElementString("E19_07", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"].vSet[0]]);
                    }
                }
                else {
                    for (var i = 0; i < TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"].vSet.length; i++) {
                        v2XML.writeElementString("E19_07", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.07"].vSet[i]));
                    }
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.08"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.08"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.08"][0]) != -1) {
                        v2XML.writeElementString("E19_08", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.08"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_08", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.08"].vSet[0]));
                }
            };


            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.09"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.09"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.09"].vSet[0]) != -1) {
                        v2XML.writeElementString("E19_09", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.09"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_09", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.09"].vSet[0]));
                }
            };
            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.10"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.10"].IsNull == true) {
                    if (specVal.indexOf(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.10"].vSet[0]) != -1) {
                        v2XML.writeElementString("E19_10", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.10"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E19_10", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.10"].vSet[0]));
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.11"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.11"].IsNull != true) {
                    v2XML.writeElementString("E19_10", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.11"].vSet[0]));

                }
            };;

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.12"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.12"].IsNull != true) {
                    v2XML.writeElementString("E19_11", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.12"].vSet[0]));
                }
            };

            if (typeof TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.13"] != 'undefined') {
                if (TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.13"].IsNull == true) {
                    v2XML.writeElementString("E19_12", specMap[TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.13"].vSet[0]]);
                }
                else {
                    v2XML.writeElementString("E19_12", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.13"].vSet[0]));
                }
            };
            v2XML.writeEndElement();

            if (typeof TheCall.eAirway["eAirway.03"] != 'undefined') {
                if (TheCall.eAirway["eAirway.03"] == "4003003") {
                    v2XML.writeElementString("E19_13", setV2(TheCall.eProcedures.ProcedureGroup[xx]["eProcedures.13"].vSet[0]));
                }
                else {
                    v2XML.writeElementString("E19_13", "-25");
                }
            }
            else {
                v2XML.writeElementString("E19_13", "-5");
            };

            v2XML.writeElementString("E19_14", "-5");
        }
        v2XML.writeEndElement();
    };
    
    
     
    if (typeof TheCall.eDisposition != 'undefined')
    {
        v2XML.writeStartElement("E20");
        if (TheCall.eDisposition.DestinationGroup == 1)
        {
            
            if (typeof TheCall.eDisposition["eDisposition.01"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.01"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.01"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_01", specMap[TheCall.eDisposition["eDisposition.01"].vSet[0]]);
                    }
                }
                else
                {
                    v2XML.writeElementString("E20_01", TheCall.eDisposition["eDisposition.01"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.02"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.02"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.02"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_02", specMap[TheCall.eDisposition["eDisposition.02"].vSet[0]]);
                    }
                }
                else {
                    v2XML.writeElementString("E20_02", TheCall.eDisposition["eDisposition.02"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.03"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.03"].IsNull != true)
                {
                    v2XML.writeElementString("E02_03", TheCall.eDisposition["eDisposition.03"].vSet[0]);
                }
            };
            if (typeof TheCall.eDisposition["eDisposition.04"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.04"].IsNull != true)
                {
                    v2XML.writeElementString("E02_04", TheCall.eDisposition["eDisposition.04"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.05"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.05"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.05"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_05", specMap[TheCall.eDisposition["eDisposition.05"].vSet[0]]);
                    }
                }
                else
                {
                    v2XML.writeElementString("E20_05", TheCall.eDisposition["eDisposition.05"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.06"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.06"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.06"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_06", specMap[TheCall.eDisposition["eDisposition.06"].vSet[0]]);
                    }
                }
                else
                {
                    v2XML.writeElementString("E20_06", TheCall.eDisposition["eDisposition.06"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.07"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.07"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.07"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_07", specMap[TheCall.eDisposition["eDisposition.07"].vSet[0]]);
                    }
                }
                else
                {
                    v2XML.writeElementString("E20_07", TheCall.eDisposition["eDisposition.07"].vSet[0]);
                }
            };

            if (typeof TheCall.eDisposition["eDisposition.09"] != 'undefined')
            {
                if (TheCall.eDisposition["eDisposition.09"].IsNull != true)
                {
                    v2XML.writeElementString("E20_08", TheCall.eDisposition["eDisposition.09"].vSet[0]);
                }
            };

            v2XML.writeElementString("E20_09", "-10");


        };
        if (typeof TheCall.eDisposition["eDisposition.12"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.12"].vSet.length != 1)
            {
                if (TheCall.eDisposition["eDisposition.12"].IsNull == true)
                {
                    if (specVal.indexOf(TheCall.eDisposition["eDisposition.12"].vSet[0]) != -1)
                    {
                        v2XML.writeElementString("E20_10", specMap[TheCall.eDisposition["eDisposition.12"].vSet[0]]);
                    }
                }
            }
            else
            {
                v2XML.writeElementString("E20_10", TheCall.eDisposition["eDisposition.12"].vSet[0]);
            }
        };

        if (typeof TheCall.eDisposition["eDisposition.13"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.13"].IsNull != true)
            {
                for (var d = 0; d < TheCall.eDisposition["eDisposition.13"].vSet.length; d++)
                {
                    v2XML.writeElementString("E20_11", setV2("eDisposition.13", TheCall.eDisposition["eDisposition.13"].vSet[d]));
                }
            }
        };

        if (typeof TheCall.eDisposition["eDisposition.14"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.14"].IsNull != true)
            {
                for (var d = 0; d < TheCall.eDisposition["eDisposition.14"].vSet.length; d++)
                {
                    v2XML.writeElementString("E20_12", setV2("eDisposition.14", TheCall.eDisposition["eDisposition.14"].vSet[d]));
                }
            }
        };

        if (typeof TheCall.eDisposition["eDisposition.15"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.15"].IsNull != true)
            {
                for (var d = 0; d < TheCall.eDisposition["eDisposition.15"].vSet.length; d++)
                {
                    v2XML.writeElementString("E20_13", setV2("eDisposition.15", TheCall.eDisposition["eDisposition.15"].vSet[d]));
                }
            }
        };

        if (typeof TheCall.eDisposition["eDisposition.17"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.17"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eDisposition["eDisposition.17"].vSet[0]) != -1)
                {
                    v2XML.writeElementString("E20_14", specMap[TheCall.eDisposition["eDisposition.17"].vSet[0]]);
                }
            }
            else
            {
                v2XML.writeElementString("E20_14", setV2("eDisposition.17", TheCall.eDisposition["eDisposition.17"].vSet[0]));
            }
        };


        if (typeof TheCall.eDisposition["eDisposition.19"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.17"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eDisposition["eDisposition.19"].vSet[0]) != -1)
                {
                    v2XML.writeElementString("E20_15", specMap[TheCall.eDisposition["eDisposition.19"].vSet[0]]);
                }
            }
            else
            {
                v2XML.writeElementString("E20_15", setV2("eDisposition.19", TheCall.eDisposition["eDisposition.19"].vSet[0]));
            }
        };


        if (typeof TheCall.eDisposition["eDisposition.20"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.20"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eDisposition["eDisposition.20"].vSet[0]) != -1)
                {
                    v2XML.writeElementString("E20_16", specMap[TheCall.eDisposition["eDisposition.20"].vSet[0]]);
                }
            }
        }
        else
        {
            for (var d = 0; d < TheCall.eDisposition["eDisposition.20"].vSet.length; d++)
            {
                v2XML.writeElementString("E20_16", setV2("eDisposition.20", TheCall.eDisposition["eDisposition.20"].vSet[d]));
            }
        };

        if (typeof TheCall.eDisposition["eDisposition.21"] != 'undefined')
        {
            if (TheCall.eDisposition["eDisposition.21"].IsNull == true)
            {
                if (specVal.indexOf(TheCall.eDisposition["eDisposition.21"].vSet[0]) != -1)
                {
                    v2XML.writeElementString("E20_17", specMap[TheCall.eDisposition["eDisposition.21"].vSet[0]]);
                }
            }
            else
            {
                v2XML.writeElementString("E20_17", setV2("eDisposition.21", TheCall.eDisposition["eDisposition.21"].vSet[0]));
            }
        };

        v2XML.writeEndElement()
    };
        

    if (typeof TheCall.eDevice != 'undefined') {
        v2XML.writeStartElement("E21")
        for (var xx = 0; xx < TheCall.eDevice.DeviceGroup.length; xx++) {
            if (typeof TheCall.eDevice["eDevice.02"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.02"].IsNull != true) {
                    v2XML.writeElementString("E21_01", TheCall.eDevice.DeviceGroup[xx]["eDevice.01"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.03"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.03"].IsNull != true) {
                    for (var d = 0; d < TheCall.eDevice.DeviceGroup[xx]["eDevice.03"].vSet.length; d++) {
                        v2XML.writeElementString("E21_02", setV2("eDevice.03", TheCall.eDevice.DeviceGroup[xx]["eDevice.03"].vSet[d]));
                    }
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.04"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.04"].IsNull != true) {
                    v2XML.writeElementString("E21_03", TheCall.eDevice.DeviceGroup[xx]["eDevice.04"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.05"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.05"].IsNull != true) {
                    v2XML.writeElementString("E21_04", TheCall.eDevice.DeviceGroup[xx]["eDevice.05"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.06"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.06"].IsNull != true) {
                    v2XML.writeElementString("E21_05", TheCall.eDevice.DeviceGroup[xx]["eDevice.06"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.07"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.07"].IsNull != true) {
                    for (var d = 0; d < TheCall.eDevice.DeviceGroup[xx]["eDevice.07"].vSet.length; d++) {
                        v2XML.writeElementString("E21_06", TheCall.eDevice.DeviceGroup[xx]["eDevice.07"].vSet[d]);
                    }
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.08"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.08"].IsNull != true) {
                    v2XML.writeElementString("E21_07", TheCall.eDevice.DeviceGroup[xx]["eDevice.08"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.09"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.09"].IsNull != true) {
                    v2XML.writeElementString("E21_08", TheCall.eDevice.DeviceGroup[xx]["eDevice.09"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.10"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.10"].IsNull != true) {
                    v2XML.writeElementString("E21_09", TheCall.eDevice.DeviceGroup[xx]["eDevice.10"].vSet[0]);
                }
            };

            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.11"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.11"].IsNull != true) {
                    v2XML.writeElementString("E21_09", TheCall.eDevice.DeviceGroup[xx]["eDevice.11"].vSet[0]);
                }
            };
            if (typeof TheCall.eDevice.DeviceGroup[xx]["eDevice.12"] != 'undefined') {
                if (TheCall.eDevice.DeviceGroup[xx]["eDevice.12"].IsNull != true) {
                    v2XML.writeElementString("E21_11", TheCall.eDevice.DeviceGroup[xx]["eDevice.12"].vSet[0]);
                }
            };

            v2XML.writeEndElement()
        }
    };

    if (typeof TheCall.eOutcome != 'undefined') {
        v2XML.writeStartElement("E22")
        if (typeof TheCall.eOutcome["eOutcome.01"] != 'undefined') {
            if (TheCall.eOutcome["eOutcome.01"].IsNull == true) {
                if (specVal.indexOf(TheCall.eOutcome["eOutcome.01"].vSet[0]) != -1) {
                    v2XML.writeElementString("E22_01", specMap[TheCall.eOutcome["eOutcome.01"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E22_01", setV2("eOutcome.01", TheCall.eOutcome["eOutcome.01"].vSet[0]));
            }
        };

        if (typeof TheCall.eOutcome["eOutcome.02"] != 'undefined') {
            if (TheCall.eOutcome["eOutcome.02"].IsNull == true) {
                if (specVal.indexOf(TheCall.eOutcome["eOutcome.02"].vSet[0]) != -1) {
                    v2XML.writeElementString("E22_02", specMap[TheCall.eOutcome["eOutcome.02"].vSet[0]]);
                }
            }
            else {
                v2XML.writeElementString("E22_02", setV2("eOutcome.02", TheCall.eOutcome["eOutcome.02"].vSet[0]));
            }
        };
        v2XML.writeElementString("E22_03", "-10");
        v2XML.writeElementString("E22_04", "-10");
        v2XML.writeElementString("E22_05", "-10");
        v2XML.writeElementString("E22_06", "-10");
        v2XML.writeEndElement();
    };

    if (typeof TheCall.eOther != 'undefined')
        {
    v2XML.writeStartElement("E23")
    if (typeof TheCall.eOther["eOther.01"] != 'undefined') 
    {
        if (TheCall.eOther["eOther.01"].IsNull != true) 
        {
            v2XML.writeElementString("E23_01", TheCall.eOther["eOther.01"].vSet[0]);
        }        
    };


    if (typeof TheCall.eOther["eOther.02"] != 'undefined') 
    {
        if (TheCall.eOther["eOther.02"].IsNull != true) 
        {
            for (var d = 0; d < TheCall.eOther["eOther.02"].vSet.length; d++) 
            {
                v2XML.writeElementString("E23_02", TheCall.eOther["eOther.02"].vSet[0]);
            }   
        }        
    };

    if (typeof TheCall.eOther["eOther.03"] != 'undefined') 
    {
        if (TheCall.eOther["eOther.03"].IsNull != true) 
        {
            for (var d = 0; d < TheCall.eOther["eOther.03"].vSet.length; d++) 
            {
                v2XML.writeElementString("E23_03", setV2("eOther.03", TheCall.eOther["eOther.03"].vSet[0]));
            }   
        }        
    };

    if (typeof TheCall.eOther["eOther.05"] != 'undefined') {
        if (TheCall.eOutcome["eOutcome.05"].IsNull == true) {
            if (specVal.indexOf(TheCall.eOther["eOther.05"].vSet[0]) != -1) {
                v2XML.writeElementString("E23_05", specMap[TheCall.eOther["eOther.05"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E23_05", setV2("eOther.05", TheCall.eOther["eOther.05"].vSet[0]));
        }
    };

    if (typeof TheCall.eOther["eOther.06"] != 'undefined') 
    {
        if (TheCall.eOutcome["eOutcome.06"].IsNull == true) {
            if (specVal.indexOf(TheCall.eOther["eOther.06"].vSet[0]) != -1) {
                v2XML.writeElementString("E23_06", specMap[TheCall.eOther["eOther.06"].vSet[0]]);
            }
        }
        else {

            for (var d = 0; d < TheCall.eOther["eOther.06"].vSet.length; d++) {
                v2XML.writeElementString("E23_06", setV2("eOther.06", TheCall.eOther["eOther.06"].vSet[i]));
            }
        }
    };

    if (typeof TheCall.eOther["eOther.07"] != 'undefined') 
    {
        if (TheCall.eOther["eOther.07"].IsNull != true) 
        {
            for (var d = 0; d < TheCall.eOther["eOther.07"].vSet.length; d++) 
            {
                v2XML.writeElementString("E23_04", setV2("eOther.07", TheCall.eOther["eOther.07"].vSet[i]));
            }   
        }        
    };

    v2XML.writeElementString("E23_07", "-10");
    v2XML.writeElementString("E23_08", "-10");
    v2XML.writeElementString("E23_08", "-5");
    if (typeof TheCall.eOther["eOther.08"] != 'undefined') {
        if (TheCall.eOutcome["eOutcome.08"].IsNull == true) {
            if (specVal.indexOf(TheCall.eOther["eOther.08"].vSet[0]) != -1) {
                v2XML.writeElementString("E23_10", specMap[TheCall.eOther["eOther.08"].vSet[0]]);
            }
        }
        else {
            v2XML.writeElementString("E23_10", setV2("eOther.08", TheCall.eOther["eOther.08"].vSet[0]));
        }
    };

        v2XML.writeEndElement()
    };

    v2XML.writeEndElement();
    v2XML.writeEndElement();
    //XML.writeAttributeString('timeStamp', Data);
    var XMLDoc = v2XML.flush()
    console.log(XMLDoc)
    return v2XML;

};
